var DEBUG_MODE_ENABLED=getTopWindow?(getTopWindow().PROTOTYPE_DEBUG||(getTopWindow().wlName&&getTopWindow().wlName.endsWith("_developer"))):false;Prototype.falseFunction=function(){return false};Prototype.noParallelExecution=function(c,b,e,d){var a=false;if(b){a=("cm4all-guard-lock-"+new String(new Date().getTime()+Math.random()).replace(/\./,"-"));return function(){var g,f;var h=this;if(this[a]){if(typeof e==="function"){e.apply(this,arguments)}return undefined}this[a]=true;var j=function(){delete h[a]};try{if(d){f=$A(arguments).clone();f.unshift(j);g=c.apply(this,f)}else{g=c.apply(this,arguments);j()}}catch(i){j();throw i}return g}}else{return function(){var f;if(a){if(typeof e==="function"){e.apply(this,arguments)}return undefined}a=true;var h=function(){a=false};try{if(d){args=$A(arguments).clone();args.unshift(h);f=c.apply(this,args)}else{f=c.apply(this,arguments);h()}}catch(g){h();Common.log(g);throw g}return f}}};Object.extend(Prototype.Browser,{IE6:Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==6,IE7:Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==7,IE8:Prototype.Browser.IE&&parseInt(navigator.userAgent.substring(navigator.userAgent.indexOf("MSIE")+5))==8,IE8inIE7compatMode:document.documentMode&&document.documentMode==7});if(Prototype.Browser.IE){Prototype.Browser.Version=parseFloat(navigator.userAgent.replace(/^(.*MSIE )(\d+\.\d+)(.*)$/,"$2"))||0}else{if(Prototype.Browser.WebKit){Prototype.Browser.Version=parseFloat(navigator.userAgent.replace(/^(.*AppleWebKit\/)(\d+\.\d+)(.*)$/,"$2"))||0}else{if(Prototype.Browser.Gecko){Prototype.Browser.Version=parseFloat(navigator.userAgent.replace(/^(.*Firefox\/)(\d+\.\d+)(.*)$/,"$2"))||0}}}if(!Prototype.Browser.IE&&navigator.userAgent.indexOf("Trident/")!=-1){Prototype.Browser.Gecko=false;Prototype.Browser.Trident=true;Prototype.Browser.Version=parseFloat(navigator.userAgent.replace(/^(.*Trident\/)(\d+\.\d+)(.*)$/,"$2"))||0}Ajax.Request.ReauthImageSrc="/res/js/prototype/keepalive.gif";Ajax.Request.ReauthLoopTimeout=10;if(!Object.isFunction(Ajax.Request.prototype._extended_by_prototype_impl)){Object.extend(Ajax.Request.prototype,{_extended_by_prototype_impl:Prototype.emptyFunction,_orig_initialize:Ajax.Request.prototype.initialize,_orig_setRequestHeaders:Ajax.Request.prototype.setRequestHeaders,_orig_respondToReadyState:Ajax.Request.prototype.respondToReadyState,setRequestHeaders:function(){if(typeof(this.options.requestHeaders)=="object"&&this.options.requestHeaders==null){delete this.options.requestHeaders}var a=(Object.isFunction(window.getTopWindow)?window.getTopWindow().cm4allSecToken:"");if(a!=""){this.options.requestHeaders=this.options.requestHeaders||[];if(Object.isFunction(this.options.requestHeaders.push)){this.options.requestHeaders.push("x-cm4all-sectoken");this.options.requestHeaders.push(a)}else{this.options.requestHeaders["x-cm4all-sectoken"]=a}}this._orig_setRequestHeaders()},success:function(){var a=this.getStatus();return(a>=200&&a<300)},initialize:function(b,a){this._orig_url=b;this._orig_options=a||{};this.reinit()},reinit:function(){this._orig_initialize(this._orig_url,this._orig_options)},onerror:function(){var c=getTopWindow();if(!c){return}if(DEBUG_MODE_ENABLED&&!confirm("Do prototype_reauth reload?")){return}var b=new URL(c.document.location.href,true,true);var a=Math.floor(new Date().getTime()/1000);var e=Number(b.getParameter("prototype_reauth","0"));var d=(a-e);if(String(d)=="NaN"||d>Ajax.Request.ReauthLoopTimeout){if(c!=window.top){window.top.close()}b.setParameter("prototype_reauth",a,true);c.document.location.href=b.toExternalForm()}},respondToReadyState:function(a){var b=Ajax.Request.Events[a];if(b=="Complete"){if(this.getHeader("X-CM4all-SAM-Login")){this.onerror();return}if(!this.success()&&!this.reauthImage&&!this._orig_options._skip_error_handling){if((document.defaultView||document.parentWindow)&&document.readyState!="uninitialized"){this.reauthImage=document.createElement("img");Event.observe(this.reauthImage,"load",this.reinit.bind(this));Event.observe(this.reauthImage,"error",this.onerror.bind(this));this.reauthImage.src=new URL(Ajax.Request.ReauthImageSrc).toExternalForm();return}}this.reauthImage=null}this._orig_respondToReadyState(a)}})}Object.extend(Element,{create:function(b){if(!b||!b.nodeName){return null}var a=document.createElement(b.nodeName);a.className=b.className||"";if(b.id){a.id=b.id}if(b.attributes){var c;for(c in b.attributes){a[c]=b.attributes[c]}}if(b.parent){b.parent.insertBefore(a,b.ref||null)}return a},removeAllChildren:function(a){if(typeof(a)=="string"){a=$(a)}while(a.lastChild!=null){a.removeChild(a.lastChild)}},setZebra:function(c){var d=$(c);var e=0;for(var f=d.firstChild;f!=null;f=f.nextSibling){if(f.nodeType==Node.ELEMENT_NODE&&(f.nodeName.toUpperCase()=="TR"||f.nodeName.toUpperCase()=="SPAN")){var b=((e%2)?"zebra_even":"zebra_odd");var a=((e%2)?"zebra_odd":"zebra_even");e++;if(f.className.indexOf(b)==-1){Element.removeClassName(f,a);Element.addClassName(f,b)}}}}});Element.addMethods({showIf:function(b,a){b=$(b);Element[a?"show":"hide"](b);return b},vvisible:function(a){return $(a).style.visibility!="hidden"},vtoggle:function(a){a=$(a);Element[Element.vvisible(a)?"vhide":"vshow"](a);return a},vhide:function(a){$(a).style.visibility="hidden";return a},vshow:function(a){$(a).style.visibility="visible";return a},vshowIf:function(b,a){b=$(b);Element[a?"vshow":"vhide"](b);return b}});if(Prototype.Browser.Trident){Element._orig_makePositioned=Element.makePositioned;Element.addMethods({makePositioned:function(a){if(Element.hasClassName(a.parentNode,"ui-cm4all-scrollable-carousel-inner")){return a}return Element._orig_makePositioned(a)}})}Object.extend(Form.Methods,{focusFirstElement:function(b){b=$(b);var a=b.findFirstElement();if(a){a.activate()}return b}});Object.extend(Form,Form.Methods);(function(a){Object.extend(Element.Methods,{absolutize:function(){var b=a.apply(this,arguments);if(b.getStyle("box-sizing")==="border-box"){var c=b.getLayout();b.setStyle({width:(c.get("border-box-width")+c.get("border-left")+c.get("border-right"))+"px",height:(c.get("border-box-height")+c.get("border-top")+c.get("border-bottom"))+"px"})}}})})(Element.Methods.absolutize);Object.extend(Element,Element.Methods);Object.extend(Element.Methods.ByTag,{FORM:Object.clone(Form.Methods)});Object.extend(Node,{getElementsByAttributeValue:function(b,a,c){return Node.getElementsByNameAndAttributeValue(b,"*",a,c)},getElementsByNameAndAttributeValue:function(c,e,b,d){var a=c.getElementsByTagName(e);return $A(a).inject([],function(f,g){if(g.getAttribute(b)==d){f.push(g)}return f})},getNodeValue:function(a,d){var c=$A(a.childNodes).find(function(e){return e.nodeName==d});if(c!=null){var b=c.firstChild;if(b!=null&&(b.nodeType==Node.TEXT_NODE||b.nodeType==Node.CDATA_SECTION_NODE)){return""+b.data}}return""},setNodeValue:function(b,e,a){var d=$A(b.childNodes).find(function(f){return f.nodeName==e});if(d==null){d=b.ownerDocument.createElement(e);b.insertBefore(d,b.firstChild)}var c=d.firstChild;if(c!=null&&(c.nodeType==Node.TEXT_NODE||c.nodeType==Node.CDATA_SECTION_NODE)){c.data=a}else{while(d.firstChild!=null){d.removeChild(d.firstChild)}d.appendChild(b.ownerDocument.createTextNode(a))}}});document.getElementsByAttributeName=function(c,a){var b=($(a)||document.body).getElementsByTagName("*");return $A(b).inject([],function(d,e){if(e.getAttribute(c)){d.push(e)}return d})};Object.extend(Form,{getRadioValue:function(c,b){c=$(c);var a=$A(c.elements).find(function(d){if(d.tagName.toLowerCase()=="input"&&d.type.toLowerCase()=="radio"&&d.name==b&&d.checked){return d.value}});if(a){return $(a).getValue()}else{return""}}});if(!Object.isFunction(Abstract.EventObserver.prototype._extended_by_prototype_impl)){Object.extend(Abstract.EventObserver.prototype,{_extended_by_prototype_impl:Prototype.emptyFunction,_orig_initialize:Abstract.EventObserver.prototype.initialize,initialize:function(b,c,a){this.withKeyUp=(a===true);this._orig_initialize(b,c)},_orig_registerCallback:Abstract.EventObserver.prototype.registerCallback,registerCallback:function(a){this._orig_registerCallback(a);if(this.withKeyUp&&a.type){switch(a.type.toLowerCase()){case"password":case"text":case"textarea":Event.observe(a,"keyup",this.onElementEvent.bind(this));break}}},reset:function(){this.lastValue=this.getValue()}})}Object.extend(Array.prototype,{without:function(){var a;if(arguments.length==1&&Object.isArray(arguments[0])){a=$A(arguments[0])}else{a=$A(arguments)}return this.select(function(b){return !a.include(b)})},insertBefore:function(a,b){var c=(b?this.indexOf(b):this.length);c=(c>=0?c:this.length);this.splice(c,0,a);return this},swap:function(d,c){var b=this.indexOf(d);var a=this.indexOf(c);if(b>=0&&a>=0){this[b]=c;this[a]=d}return this}});Object.extend(Object,{cloneDeep:function(b){if(Object.isArray(b)){b=b.collect(function(d){return Object.cloneDeep(d)})}else{if(Object.isHash(b)){b=new Hash(Object.cloneDeep(b.toObject()))}else{if(typeof b==="object"){var a={};for(var c in b){a[c]=Object.cloneDeep(b[c])}b=a}}}return b},ensureArray:function(a){if(!Object.isArray(a)){a=[a]}return a}});(function(){function a(c,b){if(c.hasOwnProperty("equals")){return}Object.defineProperty(c,"equals",{enumerable:false,writable:true,value:function(d){if(d===null&&typeof d!==b){return false}return(this.valueOf()===d.valueOf())}})}(function(b){if(b.hasOwnProperty("equals")){return}Object.defineProperty(b,"equals",{enumerable:false,writable:true,value:function(c){return(this===c)}})})(Object.prototype);a(String.prototype,"string");a(Number.prototype,"number");a(Boolean.prototype,"boolean");Object.areEqual=function(d,c){var e;var b={};if(d===c){return true}if(d===null||c===null||typeof d==="undefined"||typeof c==="undefined"){return false}if(d.equals(c)){return true}if(typeof d==="object"&&typeof c==="object"){for(e in d){if(!Object.areEqual(d[e],c[e])){return false}b[e]=true}for(e in c){if(b[e]){continue}if(!Object.areEqual(c[e],d[e])){return false}}return true}return false}})();var Script={head:null,loaded:{},loadedCss:{},data:{},nextId:0,getHead:function(){if(!Script.head){Script.head=document.getElementsByTagName("head")[0]}},load:function(){var c=Script.nextId++;var a=$A(arguments);var b=Script.data[c]={toload:[],callback:(typeof(a.first())=="function"?a.shift():null),sequentialLoad:(typeof(a.last())=="boolean"?a.pop():false),count:(a=a.findAll(function(d){return !Script.loaded[d]})).length};(b.sequentialLoad?a.reverse():a).each(function(e,d){if(!b.sequentialLoad||d==(b.count-1)){Script.doRequest(c,e)}else{b.toload.push(e)}})},callback:function(c,a){var b=Script.data[c];if(b){b.count--;Script.loaded[a]=true;if(b.count==0){(typeof(b.callback)=="function")&&b.callback();delete (b)}else{if(b.sequentialLoad){Script.doRequest(c,b.toload.pop())}}}},doRequest:function(b,a){if(a){new Ajax.Request(a,{method:"get",onSuccess:function(){Script.callback(b,a)},onFailure:function(){alert("Error loading: "+a)},_skip_error_handling:true})}},loadCss:function(b){Script.getHead();if(!Script.loadedCss[b]){var a=document.createElement("link");a.href=b;a.type="text/css";a.rel="stylesheet";Script.head.appendChild(a);Script.loadedCss[b]=true}}};Ajax.Document={create:(function(){var a;return function(b){if(!a){Try.these(function(){var d=new ActiveXObject("Msxml2.DOMDocument");a=arguments.callee;return d},function(){var d=document.implementation.createDocument("","",null);a=arguments.callee;return d},function(){a=Prototype.emptyFunction})}var c=a.call(this);if(c){if(b){c.appendChild(c.createElement(b))}}return c}})(),parse:function(a){return Try.these(function(){return new DOMParser().parseFromString(a,"text/xml")},function(){var b=new ActiveXObject("Msxml2.DOMDocument");b.async="false";b.loadXML(a);return b})||null},isDocument:function(a){if(a==null){return false}if(typeof(a)!="object"){return false}if(a.nodeName!="#document"){return false}if(a.documentElement==null){return false}return true},toString:function(a){var c="Ajax.isDocument : error";if(a){try{c=new XMLSerializer().serializeToString(a)}catch(b){c=a.xml}}return c}};Object.extend(String.prototype,{evalScripts:function(){return this.extractScripts().map(function(script){script=script.replace(/var __comaWidget/,"window.__comaWidget");try{return eval(script)}catch(e){}})}});if(!Object.isFunction(String.prototype.trim)){Object.extend(String.prototype,{trim:function(){return this.replace(/^\s+/,"").replace(/\s+$/,"")}})}if(DEBUG_MODE_ENABLED){Try={these:function(){var c;for(var b=0;b<arguments.length;b++){var a=arguments[b];try{c=a();break}catch(d){if(getTopWindow().console){getTopWindow().console.log(a+": "+d)}}}return c}};Ajax.Responders.register({onException:function(b,a){if(getTopWindow().console){getTopWindow().console.log(b+": "+a)}}})}$Q=function(a,b){b=$(b);return b?b.select(a):$$(a)};