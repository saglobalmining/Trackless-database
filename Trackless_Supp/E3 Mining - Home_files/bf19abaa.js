(function(){var tt,it,rt,ut,ft,et,ot,ht,ct,lt,at,vt,yt,pt,wt,bt,t,kt;try{(function(){var n={L_OverlayEntity_AddMyPlaces:"Add to Favourites",L_OverlayEntity_SaveAsFavorite:"Save as favourite",L_OverlayEntity_SaveAs:"Save as...",L_OverlayEntity_Save:"Save...",L_OverlayEntity_MoveTo:"Move to",L_AddNickNameOption:"Add a nickname",L_AddNoteOption:"Add a description",L_EditNickNameOption:"Edit nickname",L_EditNoteOption:"Edit description",L_DeleteNickNameOption:"Delete nickname",L_DeleteNoteOption:"Delete description",L_EditHomeWorkOption:"Edit",L_HideHomeWorkOption:"Hide from general Map",L_DisplayHomeWorkOption:"Always display on Map",L_OverlayEntity_AddPushpin:"Add a pin",L_OverlayEntity_Directions:"Directions",L_OverlayEntity_DirectionsTo:"Directions to",L_OverlayEntity_DirectionsFrom:"Directions from",L_OverlayEntity_AddToRoute:"Add to route",L_OverlayEntity_AddToItineraries:"Add to itinerary",L_OverlayEntity_Nearby:"Nearby",L_OverlayEntity_OpenCard:"Drop a pin",L_OverlayEntity_OpenNewCard:"Open as new card",L_TrafficScheduledConstruction_Text:"Scheduled construction",L_TrafficOtherNews_Text:"Other news",L_TrafficCongestion_Text:"Congestion",L_TrafficAccident_Text:"Accident",L_TrafficDisabledVehicle_Text:"Disabled vehicle",L_TrafficRoadHazard_Text:"Road hazard",L_TrafficUnScheduledContruction_Text:"Unscheduled construction",L_TrafficPlannedEvent_Text:"Planned event",L_TrafficMassTransit_Text:"Transit incident",L_TrafficWeather_Text:"Weather alert",L_TrafficMiscellaneous_Text:"Miscellaneous",L_TrafficSeverityMinor_Text:"Minor",L_TrafficSeverityModerate_Text:"Moderate",L_TrafficSeveritySerious_Text:"Serious",L_TrafficSeverityLowImpact_Text:"Low impact",L_TrafficPopupSeverity_Text:"Severity:",L_TrafficPopupStartTime_Text:"Start time:",L_TrafficPopupEstEndTime_Text:"Est. end time:",L_TrafficPopupDescription_Text:"Description:",L_TrafficRecentCamerasTitle:"Recently viewed cameras",L_TrafficPopularCamerasTitle:"Popular cameras",L_TrafficIncidentsTitle:"Notifications",L_TrafficLegendsTitle:"Traffic legend",L_TrafficLegendsHeavy:"Heavy",L_TrafficLegendsModerate:"Moderate",L_TrafficLegendsLight:"Light",L_TrafficLegendsNoTraffic:"No traffic",L_TrafficLegendsClosed:"Road closed",L_TrafficLegendsSlow:"Slow",L_TrafficLegendsFast:"Fast",L_TrafficModuleMoreLink:"see more",L_TrafficModuleLessLink:"see less",L_TrafficBackButtonText:"return to summary",L_TrafficTaskTitle_Text:"Traffic",L_TrafficsZoomInNotification:"Zoom in to see more cameras",L_TrafficsNoCameraNotification:"Sorry, but there are no cameras in this area",L_TrafficsToggleCameras:"Cameras",L_TrafficCameraDirectionNorth_Text:"Camera facing North",L_TrafficCameraDirectionSouth_Text:"Camera facing South",L_TrafficCameraDirectionEast_Text:"Camera facing East",L_TrafficCameraDirectionWest_Text:"Camera facing West",L_InfoboxCloseToolTip_Text:"Close",L_TrafficCameraDisclaimer_Text:"Traffic camera images must not be viewed while driving. In law, a person may be regarded as driving a vehicle whenever the engine is running.",L_StreetsideNoCoverageInstructions_Text:"Tap on a highlighted road to enter Streetside.",L_NavBarLocateMeToolTip_Text:"Locate me",L_NavBarMapSwitcherToolTip_Text:"Change the map style",L_NavBarRotateCCToolTip_Text:"Rotate left\r\n",L_NavBarRotateToolTip_Text:"Reset orientation",L_NavBarRotateCToolTip_Text:"Rotate right",L_NavBarStreetsideLabel_Text:"Streetside",L_NavBarTrafficLabel_Text:"Traffic",L_NavBarBirdseyeV2ExitTip_Text:"Exit Bird's eye",L_NavBarBirdseyeV2NotAvailableTip_PrimaryText:"No imagery available beyond this",L_NavBarBirdseyeV2NotAvailableTip_SecondaryText:"Pan to other areas with coverage",L_NavBarBirdseyeV2NotAvailableRotationTip_PrimaryText:"Rotation not available",L_NavBarZoomInToolTip_Text:"Zoom in",L_NavBarZoomOutToolTip_Text:"Zoom out",L_NavBarCloseRadialMenuToolTip_Text:"Close",L_NavBarOpenRadialMenuToolTip_Text:"View aerial, birds eye, and more...",L_StreetsideNoCoverageInMapView_Text:"Streetside is not available here. Press ESC to exit.",L_StreetsideMobileNoCoverageInMapView_Text:"Streetside is not available here.",L_OverlayEntity_Streetside:"View streetside",L_OverlayEntity_BirdseyeV2:"View bird's eye",L_OverlayEntity_Zoom:"Zoom in",L_ScaleBarKilometers_Text:"km",L_ScaleBarMeters_Text:"m",L_ScaleBarMiles_Text:"miles",L_ScaleBarYards_Text:"yards",L_ScaleBarFeet_Text:"feet",L_TrafficDateTimeFormat:"{0} {1}",L_LocateMe_ChangeSettings_Text:"Manually change my location setting",L_LocateMe_Error_Text_Approximate_Location:"We could not retrieve your exact location, but think you may be in this area.",L_LocateMe_Error_Text_Setting:"We could not retrieve your exact location. This is your default location setting.",L_StreetsideAutoEntryTooltip_Text:"Did you know you can click on the blue lines to enter Streetside?",L_CurrentMapTypeToolTip_Text:"Current Map Type: {mapStyle}",L_RadialMenuAerialButtonToolTip_Text:"Aerial",L_RadialMenuAerialButtonDescription_Text:"A detailed look from above",L_RadialMenuBirdseyeButtonToolTip_Text:"Bird's eye",L_RadialMenuBirdseyeButtonDescription_Text:"A better angle of aerial photography",L_RadialMenuOrdnanceSurveyButtonToolTip_Text:"Ordnance Survey",L_RadialMenuOrdnanceSurveyButtonDescription_Text:"Maps for outdoors",L_RadialMenuSeasonalButtonToolTip_Text:"Spooky",L_RadialMenuSeasonalButtonDescription_Text:"A special edition map for Halloween",L_RadialMenuRoadButtonToolTip_Text:"Road",L_RadialMenuRoadButtonDescription_Text:"A standard road map",L_RadialMenuStreetsideButtonToolTip_Text:"Streetside",L_RadialMenuStreetsideButtonDescription_Text:"Explore at eye level",L_DropDownMenuLabelToggleButtonToolTip_Text:"Labels",L_DropDownMenuLabelToggleButtonDescription_Text:"for Aerial and Bird's eye",L_OverlayEntity_AddAPushpin:"Add a drawing pin",L_WalkingTime:"{0} min walk",L_NearbyParkingTitle:"Parking near {0}",L_NearbyParkingError:"Sorry. No nearby parking found!",L_CameraImageErrorText:"This camera feed is currently unavailable. Please try again later.\r\n",L_OverlayEntity_Coordinates:"Coordinates",L_OverlayEntity_Copy_Coordinates:"Copy",L_OverlayEntity_Copy_Succeeded:"Copied",L_OverlayEntity_ZoomOut:"Zoom out",L_OverlayEntity_Measure:"Measure distance",L_GeochainWorldText:"World",L_NavBarMapTypeSwitcherToolTip_Text:"Switch to {0}",L_NavBarTrafficToggleToolTip_TurnOn_Text:"Turn on traffic",L_NavBarTrafficToggleToolTip_TurnOff_Text:"Turn off traffic",L_DropDownMenuLabelToggleButtonDescription_Text_AerialOnly:"for Aerial",L_DropDownMenuLabelToggleButtonDescription_Text_RoadAerial:"for Road and Aerial",L_DropDownMenuLabelToggleButtonDescription_Text_RoadAerialBirdseye:"for Road, Aerial and Bird's eye",L_NavBarOpenRadialMenuToolTip_NoBirdseye_text:"View aerial and more...",L_RadialMenuLabelToggleToolTip_Text:"Turn labels on or off",L_DraggableList_Keyboard_Drag_Start_Hint:"Press Enter to select the current row\r\n",L_DraggableList_Keyboard_Drag_Move_Hint:"Use the up and down arrow keys to reorder. Press Enter to deselect.",L_DraggableList_Keyboard_Drag_Top_Error_Hint:"You are in the top position",L_DraggableList_Keyboard_Drag_Bottom_Error_Hint:"You are in the bottom position",L_ZoomInButtonAriaLabel:"Current Level {0}, Zoom In ",L_ZoomOutButtonAriaLabel:"Current Level {0}, Zoom Out",L_ZoomButtonAriaLabelDisabled:"Disabled",L_RadialMenuSymbolicNightButtonToolTip_Text:"Dark road",L_RadialMenuSymbolicNightButtonDescription_Text:"A darker-styled road map",L_RadialMenuWinterButtonToolTip_Text:"Winter",L_RadialMenuWinterButtonDescription_Text:"Winterise your map",L_RadialMenuGrayscaleButtonToolTip_Text:"Greyscale",L_RadialMenuGrayscaleButtonDescription_Text:"A greyscale map",L_RadialMenuCanvasDarkButtonToolTip_Text:"Canvas Dark",L_RadialMenuCanvasDarkButtonDescription_Text:"A dark style map",L_RadialMenuCanvasLightButtonToolTip_Text:"Canvas Light",L_RadialMenuCanvasLightButtonDescription_Text:"A light style map",L_GeochainTitle_Text:"Expand/Collapse Geochain",RadialMenuBirdseyeV2ButtonDescriptionText:"We have updated Bird's Eye. {0}",RadialMenuBirdseyeV2ButtonAlternateText:"Learn more",L_NavVarBirdseyeV2TipClose:"Close",L_CmtButtonTooltip:"commutability entrance"};window.$MicrosoftMaps8.ResourceManager?window.$MicrosoftMaps8.ResourceManager.init("MapDelay",n):window.$MicrosoftMaps8.ResourcesObject=n})();var i=window.$MicrosoftMaps8,u=i.Internal,ti=u._Binding,ii=u._BoundsAccumulator,b=u.CanvasDrawingContext,n=u.ControlTemplate,r=u._Debug,ki=u._Dispatcher,ri=u._GeometryGeneralizer,f=u._Gimme,s=u._Helper,h=u._JSEvent,o=u._Observable,ui=u._ObservableCollection,k=u._ObservableObject,g=u._VectorMath,l=i.Anchor,fi=i.LocationRect,di=i.PixelCrs,a=i.Point,v=i.ResourceManager.MapDelay,c=i.Rectangle,ei=i.Size,oi=i.SimplePointPrimitive,gi=i.ViewportCrs,nr=i.ZoomLevel,d=i.GlobalConfig,nt=function(){function n(t,i,r){this._staticResources=i;this._controlFactory=r;this._disposables=[];this._parsed=typeof t=="string"?n._parseTemplate(t):t}return n.prototype.applyControlTemplate=function(n,t){return this._controlArgs=t,this._applyTemplate(this._parsed,n,null)},n.prototype.applyDataTemplate=function(n){return this._applyTemplate(this._parsed,{dataContext:n},null)},n.prototype.dispose=function(){s._clearDisposables(this._disposables);this._disposables=[]},n.prototype._applyTemplate=function(n,t,i){if(n.tagName)return this._applyTag(n,t,i);if(n instanceof Array)return this._applyArray(n,t,i);if(typeof n=="string")i&&i.appendText?i.appendText(n):i.append(n);else if(n&&n.extensionTag)switch(n.extensionTag){case"Binding":case"TemplateBinding":return this._applyBinding(n,t,i);case"StaticBinding":return this._applyBinding(n,this._staticResources,i);default:throw"Unsupported extension tag: "+n.extensionTag;}else throw"Unsupported template";},n.prototype._createPseudoParent=function(n,t){return{append:function(i){return o.setValue(n,t,i),this},obj:n,property:t}},n.prototype._applyBinding=function(n,t,i){var c=this,l=i.obj,a=i.property,f=n.namedParams||{},o=n.args||{},r=n.extensionTag==="Binding"?"dataContext":"",s,u,h,e;return o[0]&&(r.length&&(r+="."),r+=o[0]),s=f.Mode||"OneWay",u=null,f.Converter&&(u=this._staticResources[f.Converter]),h=function(n){return u?u.call(c._staticResources,n):n},e=new ti(t,r,l,a,h,s),this._disposables.push(e),e},n.prototype._applyTag=function(t,i,r){function k(t,i){if(i){i.dispose&&t.push(i);var r=i[n._controlDisposableProperty];r&&r.length&&Array.prototype.push.apply(t,r)}}var h=t.tagName,b,a,p,u,w,c,l,f,v,e,o,s,y,d;switch(h){case"ItemsPresenter":return this._applyItemsPresenter(t,i,r,"itemsSource","itemTemplate"),null;case"ContentPresenter":return b=t.attr.content||"content",this._applyItemsPresenter(t,i,r,b,"contentTemplate"),null;case"PopOutPresenter":return this._applyItemsPresenter(t,i,r,"popOutContent","popOutTemplate"),null;case"TabbedPresenter":return this._applyItemsPresenter(t,i,r,"tabContent","tabTemplate"),null;case"DataTemplate":case"ControlTemplate":return a=new n(t.content[0],this._staticResources,this._controlFactory),this._disposables.push(a),r&&r.append&&r.append(a),a}if(p=h.split("."),p.length===2){if(t.content.length!==1)throw"Node property expression must have exactly 1 child";return this._applyTemplate(t.content[0],i,this._createPseudoParent(r,p[1]))}if(u=this._controlFactory(h,this._controlArgs),!u)throw"Unable to create "+h;if(w=u,w.dispose&&this._disposables.push(w),l=t.attr,f=[],l)for(c in l)if(l.hasOwnProperty(c)){if(v=l[c],e=c.split(":"),e.length===1)o=this._applyTemplate(v,i,this._createPseudoParent(u,c));else if(e.length===2)switch(e[0]){case"event":o=this._addHandler(u,e[1],v,i.dataContext);break;case"style":o=this._applyTemplate(v,i,this._createPseudoParent(u[0].style,e[1]))}o&&o.dispose&&f.push(o)}if(r&&r.append(u),t.content)if(h==="style"&&u[0].styleSheet)u[0].styleSheet.cssText=t.content;else if(s=this._applyTemplate(t.content,i,u),s)if(s instanceof Array)for(y=0,d=s.length;y<d;y++)k(f,s[y]);else k(f,s);return f.length&&(u[n._controlDisposableProperty]=f),u},n.prototype._addHandler=function(n,t,i,r){var c=this,e=r&&o.getValue(r,i),s=this._staticResources&&this._staticResources[i],f,u;if(e)u=function(n){return e.call(r,n)};else if(s)u=function(n){return s.call(c._staticResources,n)};else return null;return n[t]instanceof h?f=n[t].add(u):(n.add_event(t,u),f={dispose:function(){n.remove_event(t,u)}}),this._disposables.push(f),f},n.prototype._applyItemsPresenter=function(t,i,r,u,f){function b(){var n=o.getValue(i,u),t=o.getValue(i,f),r=o.getValue(i,"itemContainerGenerator");(n!==h||t!==a||r!==c)&&(l&&l.dispose(),h=n,a=t,c=r,h&&(k(),l=h.changed&&h.changed.add(k),p._disposables.push(l)))}function k(t){var i,f,u,r,o,c;if(t=t||{reset:!0},t.reset||t.removed){if(e=v.nextSibling,t.removed)for(i=t.removedIndex;i--;)e=e.nextSibling;for(i=0;e&&e!==w&&(!t.removed||i<t.removed.length);)f=e.nextSibling,e.dispose&&e.dispose(),s._clearDisposables(e[n._controlDisposableProperty]),e.parentNode.removeChild(e),e=f,i++}if(t.reset||t.added){if(e=v.nextSibling,t.added)for(i=t.addedIndex;i--;)e=e.nextSibling;if(u=e,r=t.added||h,typeof r=="string"||typeof r.nodeType=="number")y(r,u);else if(r instanceof Array||r instanceof ui)for(o=r.length,i=0;i<o;i++)c=r[i],y(c,u);else y(r,u)}}function y(t,i){var u=p._renderData(t,a),f=u,e=c&&c.generateNext(t);e&&e.append(u);var f=e||u,o=u[n._controlDisposableProperty],s=f[0]||f;s[n._controlDisposableProperty]=o;r.insertBefore(f,i)}var p=this,e,h,a,c,l,v=document.createTextNode(""),w=document.createTextNode("");r.append(v).append(w);b();this._disposables.push(i.changed.add(b))},n.prototype._applyArray=function(n,t,i){for(var u=[],r=0;r<n.length;r++)u.push(this._applyTemplate(n[r],t,i));return u},n.prototype._renderData=function(n,t){return t?t.applyDataTemplate(n):n&&typeof n.nodeType=="number"?n:document.createTextNode(n?n.toString():"")},n._parseTemplate=function(n){function c(n){var t=r[r.length-1];(typeof n!="string"||(n=n.replace(v,"").trim(),n.length!==0))&&(t?(t.content||(t.content=[]),t.content.push(n)):s=n)}function y(n){var r,h,u,t,o,s,f,i,e;if(!(r=/\{(\w+)(\s+([^\}]+))?\}/g.exec(n)))return n;if(h=r[1],u={extensionTag:h},r[2]){for(t=r[2],t=t.trim().split(" "),o=[],s={},f=0;f<t.length;f++)i=t[f],e=i.indexOf("="),e===-1?o.push(i):s[i.substring(0,e)]=i.substring(e+1);u.args=o;u.namedParams=s}return u}var f,o,h;n.charAt(0)==="#"&&(n=document.getElementById(n.substr(1)).text);for(var l=/<\/?(?:(\w+):)?([\w\.]+)(?:\s*(?:\w+\:)?[\w\-]+=(?:"[^"]*"|'[^']*')\s*)*\s*(\/?)>/g,a=/((?:\w+\:)?[\w\-]+)=(?:"([^"]*)"|'([^']*)')/g,v=/<!--[\s\S]*?-->/g,s=null,r=[],t,u,e=0,i;!!(t=l.exec(n));)if(t.index>e&&c(n.substring(e,t.index)),e=t.index+t[0].length,f=t[2],t[0].charAt(1)==="/"){if(i=r.pop(),i.tagName!==f)throw"Unmatched ending tag: "+f;}else{for(o={};!!(u=a.exec(t[0]));)h=y(u[2]||u[3]||""),o[u[1]]=h;i={tagName:f,namespace:t[1],attr:o};c(i);t[3]!=="/"&&r.push(i)}return s},n._controlDisposableProperty="$ctrl_disp$",n}(),t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),n=function(n){function i(t,r){return n.call(this,t,r,i.createControl)||this}return t(i,n),i.registerControl=function(n,t){i._controls[n]=t},i.createControl=function(n,t){var r=i._controls[n];return r?new r(t):s._createElement(n)},i._controls={},i._textPrototypeAdded=!1,i}(nt),t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),e=function(i){function r(n,t){var u=i.call(this,n)||this;return n=n||u,u.disposables=[],u._controlArgs=t||{},u.disposables.push(u.rendered=new h),n.defineProperty("template",function(n,t){return u._onTemplateChanged(n,t)},r._templateConverter),u}return t(r,i),r.prototype._render=function(){var n=null,t=null,i;this._root&&(n=this._root.getParent(),t=this._root.get_sibling(1),this._root.removeFromParent());i=this.getTemplate();this._root=i?i.applyControlTemplate(this,this._controlArgs):document.createTextNode("");n&&n.length&&(t&&t.length?n.insertBefore(this._root,t):n.append(this._root));this.rendered.invoke()},r.prototype._onTemplateChanged=function(n){n&&n.dispose();this._root&&this._root.getParent()&&this._render()},r._templateConverter=function(t){return typeof t=="string"&&(t=new n(t)),t},r.prototype.boolToDisplay=function(n){return n?"":"none"},r.prototype.boolToVisibility=function(n){return n?"":"hidden"},r.prototype.appendTo=function(n){n.append(this.getRootElement())},r.prototype.getRootElement=function(){return this._root||this._render(),this._root},r.prototype.dispose=function(){var t,n;this.getTemplate&&(t=this.getTemplate(),t&&t.dispose());i.prototype.dispose.call(this);n=this._root;n&&n.removeFromParent&&n.removeFromParent();this._root=null;s._clearDisposables(this.disposables);s._nullifyClass(this)},r.prototype.setVisible=function(n){this.getRootElement().set_style({display:this.boolToDisplay(n)})},r.prototype.isTabbable=function(n){var i=n.nodeName.toLowerCase(),r=_w.getComputedStyle(n),t;return r.display==="none"||r.visibility==="hidden"?!1:/input|select|textarea|button|object/.test(i)?!n.disabled:(t=parseInt(n.getAttribute("tabindex")),"a"===i&&n.getAttribute("href")?isNaN(t)||t>=0:!isNaN(t)&&t>=0)},r.prototype.getFirstTabbableChild=function(n){for(var i,r=n.getElementsByTagName("*"),t=0;t<r.length;t++)if(i=r[t],this.isTabbable(i))return i;return null},r}(k),t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),si=function(n){function i(){var t=n.call(this)||this;return t.defineProperty("value",function(n,i){return t.onAttributeChanged("value",n,i)}),t.defineProperty("min",function(n,i){return t.onAttributeChanged("min",n,i)}),t.defineProperty("max",function(n,i){return t.onAttributeChanged("max",n,i)}),t.defineProperty("step",function(n,i){return t.onAttributeChanged("step",n,i)}),t.setTemplate('<input type="range" value="{TemplateBinding Value Mode=TwoWay}"/>'),t}return t(i,n),i.prototype.onAttributeChanged=function(t,i,r){n.prototype.getRootElement.call(this).set_attr(t,r)},i}(e);n.registerControl("Slider",si);var t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),w=function(n){function i(t){var i=n.call(this,t)||this;return t=t||i,t.defineProperty("content"),t.defineProperty("contentTemplate",function(n,t){return i._onContentTemplateChanged(n,t)}),i}return t(i,n),i.prototype._onContentTemplateChanged=function(n){n&&n.dispose()},i.prototype.dispose=function(){var t=this.getContentTemplate();t&&t.dispose();n.prototype.dispose.call(this)},i}(e),t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),y=function(n){function i(){var t=n.call(this)||this;return t._defaultTemplate="<{tag}><ItemsPresenter /><\/{tag}>",t.defineProperty("panelTagName",function(n,i){return t._onPanelTagNameChanged(n,i)},null,{defaultValue:"div"}),t.defineProperty("itemsSource"),t.defineProperty("itemTemplate",function(n,i){return t._onItemTemplateChanged(n,i)}),t._onPanelTagNameChanged(null,t.getPanelTagName()),t}return t(i,n),i.prototype._onItemTemplateChanged=function(n){n&&n.dispose()},i.prototype._onPanelTagNameChanged=function(n,t){this.setTemplate(this._defaultTemplate.replace(/{tag}/g,t))},i.prototype.dispose=function(){var t=this.getItemTemplate&&this.getItemTemplate();t&&t.dispose();n.prototype.dispose.call(this)},i}(e);n.registerControl("ItemsControl",y);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();tt=function(i){function r(){var t=i.call(this)||this;return t._templateString='<div class="{TemplateBinding ContainerClass}"><ItemsPresenter /><\/div>',t.defineProperty("sourceKey",function(){return t._onSourceChanged()}),t.defineProperty("sourceMap",function(){return t._onSourceChanged()}),t.defineProperty("containerClass"),t.setTemplate(new n(t._templateString,null)),t}return t(r,i),r.prototype._onSourceChanged=function(){var n=this.getSourceKey(),t=this.getSourceMap();n&&t&&this.setItemsSource(t[n])},r}(y);n.registerControl("MappedItemsControl",tt);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();it=function(i){function r(){var t=i.call(this)||this;return t._templateString='<div><ItemsControl ItemsSource="{TemplateBinding KeyList}" ><ItemsControl.ItemTemplate><DataTemplate><div class="{StaticBinding BlockClass}" data-key="{Binding key}" event:click="onBlockClick"><div class="{StaticBinding NameClass}"><TextBlock Text="{Binding key}" /><\/div><MappedItemsControl ContainerClass="{StaticBinding ContainerClass}" SourceKey="{Binding key}" SourceMap="{StaticBinding Dictionary}" ItemTemplate="{StaticBinding ValueTemplate}" /><\/div><\/DataTemplate><\/ItemsControl.ItemTemplate><\/ItemsControl><\/div>',t.defineProperty("keyList"),t.defineProperty("dictionary",function(){return t._updateTemplate()}),t.defineProperty("valueTemplate",function(){return t._updateTemplate()}),t.defineProperty("nameClass",function(){return t._updateTemplate()},null,{defaultValue:"hideName"}),t.defineProperty("containerClass"),t.defineProperty("blockClass"),t.onBlockClicked=new h,t.setTemplate(new n(t._templateString,null)),t}return t(r,i),r.prototype._onBlockClick=function(n){var t=f(n.currentTarget),i=t.get_attr("data-key");this.onBlockClicked.invoke(i)},r.prototype._updateTemplate=function(){var r=this,t=this.getDictionary(),i=this.getValueTemplate();t&&i&&this.setTemplate(new n(this._templateString,{Dictionary:t,ValueTemplate:i,NameClass:this.getNameClass(),ContainerClass:this.getContainerClass(),BlockClass:this.getBlockClass(),onBlockClick:function(n){r._onBlockClick(n)}}))},r}(e);n.registerControl("DictionaryItemsControl",it);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();rt=function(i){function r(){var t=i.call(this)||this;return t._templateString='<a class="{TemplateBinding buttonClass Converter=setClassName}" data-tag="{TemplateBinding buttonClass}" title="{TemplateBinding hoverText}" event:click="onButtonClick" href="#"><span class="{TemplateBinding buttonIcon Converter=setIconClassName}"> <\/span><TextBlock Text="{TemplateBinding buttonText}" /><\/a>',t.defineProperty("buttonText"),t.defineProperty("buttonClass"),t.defineProperty("buttonIcon"),t.defineProperty("hoverText"),t.click=new h,t.setTemplate(new n(t._templateString,{onButtonClick:function(n){t._onButtonClick(n)},setClassName:function(n){return t._setClassName(n)},setIconClassName:function(n){return t._setIconClassName(n)}})),t}return t(r,i),r.prototype._onButtonClick=function(n){this.click.invoke(n)},r.prototype._setClassName=function(n){return"commonButtonControl "+n},r.prototype._setIconClassName=function(n){return"buttonIcon "+n},r}(e);n.registerControl("Button",rt);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();ut=function(n){function i(){var t=n.call(this)||this;return t.defineProperty("checked"),t.defineProperty("disabled",function(n,i){var r=t.getRootElement().select("input");i?r.set_attr("disabled","disabled"):r.remove_attr("disabled")},null,{defaultValue:!1}),t.defineProperty("value"),t.setTemplate('<label><input type="checkbox" value="{TemplateBinding Value}" checked="{TemplateBinding Checked Mode=TwoWay}" data-tag="checkbox" /><ContentPresenter /><\/label>'),t}return t(i,n),i}(w);n.registerControl("CheckBox",ut);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();ft=function(i){function r(){var t=i.call(this)||this;return t.defineProperty("containerClass"),t.defineProperty("controlName",function(i,r){t._control&&t._control.dispose();t._control=null;r&&(t._control=n.createControl(r),t.rendered.addOne(function(){t._control.rendered.invoke(t);t.setControlRef(t._control)}),t.setContent(t._control),t.setContentTemplate(t._control.getTemplate()))}),t.defineProperty("controlRef"),t.setTemplate('<div class="{TemplateBinding containerClass}" ><ContentPresenter /><\/div>'),t}return t(r,i),r}(w);n.registerControl("ContainerControl",ft);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();et=function(i){function r(){var t=i.call(this)||this;return t.defineProperty("value",null,null,{defaultValue:0}),t.setTemplate(new n('<div class="starRate" event:click="onClick"><div style:width="{TemplateBinding Value Converter=valueToWidth}"><\/div><\/div>',{onClick:function(n){var i=n.offsetX||n.layerX;t.setValue(Math.floor(i/40)+1)},valueToWidth:function(n){return n*20+"%"}})),t}return t(r,i),r}(e);n.registerControl("StarRating",et);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();ot=function(i){function r(){var t=i.call(this)||this;return t.defineProperty("itemsSource"),t.defineProperty("selectedItem",t._onSelectedItemChanged),t.setTemplate(new n('<div class="radioGroup" data-tag="radioGroup"><ItemsControl ItemsSource="{TemplateBinding itemsSource}"><ItemsControl.ItemTemplate><DataTemplate><a href="#" data-value="{Binding value}" event:click="onClick"><TextBlock Text="{Binding text}" /><\/a><\/DataTemplate><\/ItemsControl.ItemTemplate><\/ItemsControl><\/div>',{onClick:function(n){var u,r,i;for(n.preventDefault(),u=n.target.getAttribute("data-value"),r=t.getItemsSource(),i=0;i<r.length;i++)if(r[i].value==u){t.setSelectedItem(r[i]);break}}})),t}return t(r,i),r.prototype._onSelectedItemChanged=function(n,t){for(var u=this.getItemsSource().indexOf(t),r=this.getRootElement().select("a"),i=0;i<r.length;i++)r[i].className=i===u?"selected":""},r}(e);n.registerControl("RadioGroup",ot);var hi='<div class="spinBox bm_disable_highlighting" data-tag="spinBox">\t<div class="cell" event:click="onCellClick"><TextBlock Text="{TemplateBinding index Converter=indexToValue}" /><\/div>\t<div class="column" tabindex="0" style:display="{TemplateBinding open Converter=boolToDisplay}" event:click="onColumnClick" event:mousewheel="onMouseWheel" event:contextmenu="onContextMenu" event:keydown="onColumnKeyDown" event:keyup="endScroll">\t\t<div class="spinBoxUpArrow" event:mousedown="onUpArrow" event:mouseup="endScroll" event:mouseout="endScroll" event:touchend="endScroll"><\/div>\t\t<div class="scrollContainer">\t\t\t<div class="selectedBg"><\/div>\t\t\t<ItemsControl ItemsSource="{TemplateBinding itemsSource}" panelTagName="ul">\t\t\t\t<ItemsControl.ItemTemplate>\t\t\t\t\t<DataTemplate>\t\t\t\t\t\t<li data-value="{Binding value}" event:click="onItemClick"><TextBlock Text="{Binding text}" /><\/li>\t\t\t\t\t<\/DataTemplate>\t\t\t\t<\/ItemsControl.ItemTemplate>\t\t\t<\/ItemsControl>\t\t<\/div>\t\t<div class="spinBoxDownArrow" event:mousedown="onDownArrow" event:mouseup="endScroll" event:mouseout="endScroll" event:touchend="endScroll"><\/div>\t<\/div><\/div>',t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),ci=function(i){function r(){var t=i.call(this)||this;return t._timerId=0,t.defineProperty("itemsSource"),t.defineProperty("index",null,null,{defaultValue:0}),t.defineProperty("open",t._onOpenChanged,null,{defaultValue:!1}),t.openEvent=new h,t._pos=0,t.setTemplate(new n(hi,{onItemClick:function(n){var i;n.preventDefault();var f=n.target.getAttribute("data-value"),r=-1,u=t.getItemsSource();for(i=u.length-1;i>=0;i--)if(u[i].value==f){r=i;break}r===t._pos?t._invokeOpenEvent():t._setPos(r)},onCellClick:function(n){n.stopPropagation();t._invokeOpenEvent()},onUpArrow:function(){t._scroll(-1,500)},onDownArrow:function(){t._scroll(1,500)},onColumnKeyDown:function(n){var r=n,i=r.keyCode||r.which;(i===38||i===40||i===13)&&(n.stopPropagation(),n.preventDefault());i===38?t._scroll(-1,500):i===40?t._scroll(1,500):i===13&&t._invokeOpenEvent()},endScroll:function(){window.clearTimeout(t._timerId)},onContextMenu:function(n){n.stopPropagation();n.preventDefault()},onColumnClick:function(n){n.stopPropagation()},onMouseWheel:function(n){n.stopPropagation();n.preventDefault();n.wheelDelta&&t._setPos(t._pos+(n.wheelDelta>0?-1:1))},indexToValue:function(n){var i=t.getItemsSource();return!i||n<0||n>=i.length?"":i[n].text},boolToDisplay:function(n){return n?"":"none"}})),t}return t(r,i),r.prototype._invokeOpenEvent=function(){this.openEvent.hasHandlersRegistered&&this.openEvent.invoke()},r.prototype._onOpenChanged=function(n,t){t?this._setPos(this.getIndex()):this.setIndex(this._pos)},r.prototype._setPos=function(n){var t=this.getRootElement().select("li"),i;n<0||n>=t.length||(i=t[n],i&&(t[this._pos].className="",this._pos=n,i.className="selected",this._listElement||(this._listElement=this.getRootElement().select("ul")),this._listElement.set_style({top:26*(2-n)+"px"})))},r.prototype._scroll=function(n,t){if(this._setPos(this._pos+n),n>0&&this._pos<this.getItemsSource().length-1||n<0&&this._pos>0){var i=this;window.clearTimeout(this._timerId);this._timerId=Microsoft.Maps.setTimeout(function(){i._scroll(n,150)},t)}},r}(e);n.registerControl("SpinBox",ci);var st='<div class="{TemplateBinding open Converter=openToClass}" data-tag="timeControl">    <SpinBox ItemsSource="{TemplateBinding col0Source}" Open="{TemplateBinding open}" Index="{TemplateBinding col0Index Mode=TwoWay}" event:openEvent="onOpen" />    <SpinBox ItemsSource="{TemplateBinding col1Source}" Open="{TemplateBinding open}" Index="{TemplateBinding col1Index Mode=TwoWay}" event:openEvent="onOpen" />    <SpinBox ItemsSource="{TemplateBinding col2Source}" Open="{TemplateBinding open}" Index="{TemplateBinding col2Index Mode=TwoWay}" event:openEvent="onOpen" />    <a href="#" class="dropdown" event:click="onDropdown"><\/a>    <div style="clear:both"><\/div><\/div>',t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),li=function(r){function u(){var t=r.call(this)||this,f,i;if(t._ignoreTimeChanged=!1,t.defineProperty("time",t._onTimeChanged),t.defineProperty("disabled",t._onDisabledChanged,null,{defaultValue:!1}),t.defineProperty("open",t._onOpenChanged,null,{defaultValue:!1,isPrivate:!0}),t.defineProperty("editing",t._onEditingChanged,null,{defaultValue:!1}),t.defineProperty("col0Index",null,null,{defaultValue:0}),t.defineProperty("col1Index",null,null,{defaultValue:0}),t.defineProperty("col2Index",null,null,{defaultValue:0}),u._sourceData||u._initializeData(),t.col0Source=u._sourceData[0],t.col1Source=u._sourceData[1],t.col2Source=u._sourceData[2],st){if(t.setTemplate(new n(st,{onDropdown:function(n){n.preventDefault();t.getDisabled()||t.toggleOpen()},onOpen:function(){t.getDisabled()||t.toggleOpen()},openToClass:function(n){return t.getDisabled()?"timeControl time_ctrl_disabled":"timeControl"+(n?" open":"")}})),f=t.getRootElement().select(".spinBox"),f)for(i=0;i<f.length;i++)u._sourceData[i]||(f[i].style.display="none");t._windowEventHandler=function(){t._onWindowEvent()}}return t}return t(u,r),u.prototype.toggleOpen=function(){var t=!this.getOpen(),n,i;if(this.setOpen(t),t)n=this.getRootElement().select(".column");else{i=this.col0Source[this.getCol0Index()].value+this.col1Source[this.getCol1Index()].value;this.col2Source&&(i+=this.col2Source[this.getCol2Index()].value);this._ignoreTimeChanged=!0;try{this.setTime(i)}catch(r){}this._ignoreTimeChanged=!1;n=this.getRootElement().select(".dropdown")}n&&n[0].focus();this.setEditing(t)},u.prototype._onTimeChanged=function(n,t){var r,f,e,i;this._ignoreTimeChanged||(r=3600,f=43200,t%=86400,e=u._amPmCol>=0,e&&(this._setIndex(u._amPmCol,Math.floor(t/f)),t%=f),i=Math.floor(t/r),e&&--i<0&&(i=11),this._setIndex(u._hoursCol,i),t%=r,this._setIndex(u._minsCol,Math.floor(t/300)))},u.prototype._onDisabledChanged=function(n,t){t&&this.getOpen()?this.toggleOpen():this.setOpen(!1)},u.prototype._setIndex=function(n,t){switch(n){case 0:this.setCol0Index(t);break;case 1:this.setCol1Index(t);break;case 2:this.setCol2Index(t)}},u.prototype._onEditingChanged=function(n,t){this.getOpen()!=t&&this.toggleOpen()},u.prototype._onOpenChanged=function(n,t){var i=this;t?Microsoft.Maps.setTimeout(function(){f(window).add_event("click,contextmenu",i._windowEventHandler)},1):n&&this._removeWindowEvents()},u.prototype._onWindowEvent=function(){this.getRootElement()[0]?this.getOpen()&&this.toggleOpen():this._removeWindowEvents()},u.prototype._removeWindowEvents=function(){var n=f(window);n.remove_event("click,contextmenu",this._windowEventHandler)},u._initializeData=function(){var o=i.GlobalConfig.dynamicProperties.cultureData,l=o.shortTimePattern+" ",e,c;u._amPmCol=-1;var t=[],f=0,r,n=0;for(e=0;e<l.length;e++){var s=l.charAt(e),h=null,a=!1;switch(s){case"h":case"H":case"m":case"t":s===r?(++n,a=!0):h=s}if(!a&&r){switch(r){case"h":c=u._createArray(1,12,1,n>1,3600,3600);c[11].value=0;t.push(c);u._hoursCol=f++;break;case"H":t.push(u._createArray(0,23,1,n>1,0,3600));u._hoursCol=f++;break;case"m":t.push(u._createArray(0,55,5,n>1,0,300));u._minsCol=f++;break;case"t":t.push([{text:o.amDesignator,value:0},{text:o.pmDesignator,value:43200}]);u._amPmCol=f++}r=null;n=0}h&&(r=h,n=1)}u._sourceData=t},u._createArray=function(n,t,i,r,u,f){for(var o=[],e=n,s=u;e<=t;e+=i,s+=f)o.push({text:(e<10&&r?"0":"")+e,value:s});return o},u}(e);n.registerControl("TimeControl",li);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();ht=function(i){function r(){var t=i.call(this)||this;return t.defineProperty("selectedItem"),t.defineProperty("itemsSource",function(n,i){t.getPopOutContent().options=i}),t.defineProperty("dropdownOpen",t._onDropdownOpenChanged,null,{isPrivate:!0}),t.defineProperty("popOutContent",null,null,{defaultValue:{options:null},isPrivate:!0}),t.dropdown=new h,t.setTemplate(new n('<span class="{TemplateBinding DropdownOpen Converter=openToCssClass}" data-tag="selectControl"><PopOutButton PopOutContent="{TemplateBinding PopOutContent}" IsDisplayed="{TemplateBinding DropdownOpen Mode=TwoWay}" ButtonText="{TemplateBinding SelectedItem.text}" ButtonClass="popOutButton dropdownBtn" ><PopOutButton.PopOutTemplate><DataTemplate><div><Dropdown ItemsSource="{Binding options}" event:onEntryClicked="onEntryClicked" ><Dropdown.ItemTemplate><DataTemplate><TextBlock Text="{Binding text}" /><\/DataTemplate><\/Dropdown.ItemTemplate><\/Dropdown><\/div><\/DataTemplate><\/PopOutButton.PopOutTemplate><\/PopOutButton><\/span>',{onEntryClicked:function(n){t.setDropdownOpen(!1);t.setSelectedItem(t.getItemsSource()[n]);Microsoft.Maps.setTimeout(function(){t.getRootElement().select(".popOutButton")[0].focus()},10)},openToCssClass:function(n){return"selectControl"+(n?" dropdownOpen":"")}})),t}return t(r,i),r.prototype._onDropdownOpenChanged=function(n,t){if(t){var i=this.getItemsSource().indexOf(this.getSelectedItem()),r=this.getRootElement().select(".dropdownEntry");i>=0&&r[i]&&Microsoft.Maps.setTimeout(function(){r[i].focus()},10)}this.dropdown.hasHandlersRegistered&&this.dropdown.invoke(t)},r}(e);n.registerControl("SelectControl",ht);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();ct=function(i){function r(){var t=i.call(this)||this;return t._templateString='<div class="tabTemplate" style:display="{TemplateBinding IsDisplayed Converter=displayTab}" ><TabbedPresenter /><\/div>',t.defineProperty("tabContent"),t.defineProperty("tabTemplate"),t.defineProperty("isDisplayed",function(n,i){return t._onDisplayChange(n,i)},null,{defaultValue:!1}),t.setTemplate(new n(t._templateString,{displayTab:function(n){return t.displayTab(n)}})),t}return t(r,i),r.prototype.displayTab=function(n){return n?"block":"none"},r.prototype._onDisplayChange=function(){},r}(e);n.registerControl("Tab",ct);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();lt=function(i){function r(){var t=i.call(this)||this;return t.itemContainerGenerator=t,t.defineProperty("selectedItem",function(n,i){return t._onSelectedItemChanged(n,i)}),t.setTemplate(new n('<select event:change="onChange"><ItemsPresenter /><\/select>',{onChange:function(){return t._onSelectionChanged()}})),t}return t(r,i),r.prototype.generateNext=function(n){var t=s._createElement("option");return n===this.getSelectedItem()&&(t[0].selected=!0),t},r.prototype._onSelectionChanged=function(){var n=this.getRootElement()[0].selectedIndex,t=this.getItemsSource();this.setSelectedItem(t[n])},r.prototype._onSelectedItemChanged=function(n,t){var u=this.getItemsSource(),i=u.indexOf(t),r;i>=0&&(r=this.getRootElement()[0],r.selectedIndex=i)},r}(y);n.registerControl("ComboBox",lt);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();at=function(i){function u(){var t=i.call(this)||this;return t._autoScrollBuffer=150,t._autoScrollStep=20,t._timeoutLength=100,t.itemContainerGenerator=t,t.onDragBegin=new h,t.onDragComplete=new h,t._timeoutId=0,t.defineProperty("draggedEntry",function(){return t._onDraggedEntryChanged}),t.setTemplate(new n('<div class="bm_draggableDisplay" event:change="onChange" event:touchmove="onDragMove" event:mousemove="onDragMove"><div event:touchend="onDragEnd" event:mouseup="onDragEnd"><ItemsPresenter /><\/div><\/div>',{onChange:function(){return t._onChanged()},onDragMove:function(n){return t._onDragMove(n)},onDragEnd:function(n){return t._onDragEnd(n)}})),t}return t(u,i),u.prototype._getPositionFieldFromPointerArgs=function(n,t){var r=n.targetTouches,u=n.touches,i,f;if(r&&r[0])i=r[0][t];else if(u&&u[0])i=u[0][t];else if(n[t])i=n[t];else if(n instanceof KeyboardEvent){if(f=n.currentTarget.getBoundingClientRect(),t.indexOf("X")>=0)return f.left;if(t.indexOf("Y")>=0)return f.top}else return-1;return i},u.prototype.generateNext=function(n){var i=this,f=this._getItemIndex(n),u=s._createElement("div"),t;return u.set_attr("data-draggable","draggable").add_class("bm_draggableDisplay"),t=s._createElement("span"),this.gripClass?t.add_class(this.gripClass):t.add_class("defaultGrip"),r.addDataTag(t,"defaultGrip"),this.tooltip&&t.set_attr("title",this.tooltip),t.set_attr("data-grip","grip").set_attr("tabindex","0").add_event("touchstart",function(n){i._onDragStart(n)}).add_event("mousedown",function(n){i._onDragStart(n)}).add_event("keydown",function(n){i._onKeyDown(n)}).add_event("focus",function(n){n.currentTarget.setAttribute("aria-label",v.L_DraggableList_Keyboard_Drag_Start_Hint)}).add_event("blur",function(n){n.currentTarget.removeAttribute("aria-label");i._isDragging&&i._onDragEnd(n,!1)}).add_event("click",function(n){i._haltEvent(n)}),u.append(t),u},u.prototype._startMovePosition=function(n,t){this._moveStartX=this._getPositionFieldFromPointerArgs(n,"pageX");this._moveStartY=this._getPositionFieldFromPointerArgs(n,"pageY");t?(this._dragPositionX=t.x,this._dragPositionY=t.y):(this._dragPositionX=this._moveStartX,this._dragPositionY=this._moveStartY);this._isDragging=!0},u.prototype._updatePosition=function(n,t,i){if(this._isDragging){if(n instanceof MouseEvent){t=0;i=0;var r=this._getPositionFieldFromPointerArgs(n,"pageX"),u=this._getPositionFieldFromPointerArgs(n,"pageY");r!==-1&&u!==-1&&(t=r-this._moveStartX,i=u-this._moveStartY)}return this._moveStartX+=t,this._moveStartY+=i,this._dragPositionX+=t,this._dragPositionY+=i,i<0?this._leadingEdgeIsTop=!0:i>0&&(this._leadingEdgeIsTop=!1),!0}return!1},u.prototype._onDragStart=function(n){this._isDragging||this._isMouseDisabled&&n instanceof MouseEvent||(n.preventDefault(),this._fixContainerHeight(),this._draggedEntryIndex=this._getDragIndex(n),this._insertIndex=this._draggedEntryIndex,this._initializeDraggablesList(),this._setThresholdArray(),this.setDraggedEntry(this._getDragElementGimme(this._draggedEntryIndex)),this._startMovePosition(n,new a(this.getDraggedEntry()[0].offsetLeft,this.getDraggedEntry()[0].offsetTop)),this._startDraggingElement(),this._updateGapAnimation(),n instanceof KeyboardEvent&&(this._isMouseDisabled=!0,this.getDraggedEntry()[0].setAttribute("aria-label",v.L_DraggableList_Keyboard_Drag_Move_Hint)),this.onDragBegin.hasHandlersRegistered&&this.onDragBegin.invoke());this._haltEvent(n)},u.prototype._onDragMove=function(n,t){if(this._isDragging&&!(this._isMouseDisabled&&n instanceof MouseEvent)){this._clearTimeOut();n.preventDefault();n instanceof KeyboardEvent&&this.getDraggedEntry()[0].setAttribute("aria-label",v.L_DraggableList_Keyboard_Drag_Move_Hint);this._determineNeedToAutoScroll(n);var i,r;t&&(i=0,r=this._getDraggedElementHeight()*t);this._updatePosition(n,i,r)&&(this._setDraggedElementPosition(),this._insertIndex=this._determineInsertIndex(t),this._updateGapAnimation(),this._haltEvent(n))}},u.prototype._onDragEnd=function(n,t){var e,i,u;t===void 0&&(t=!0);!this._isDragging||this._isMouseDisabled&&n instanceof MouseEvent||(this._clearTimeOut(),n.preventDefault(),this._isDragging=!1,e=this._draggedEntryIndex!==this._insertIndex&&t,i=null,this._stopDraggingElement(),this._stopGapAnimation(),e&&(i=this.getItemsSource()[this._draggedEntryIndex],this._reorderItemsList(),r.getFunctionalTestHooksEnabled()&&(u=f(f("[data-draggable=draggable]",this.getRootElement()[0])[this._draggedEntryIndex]),u.add_class("finishedDragging"),r.addDataTag(u,"finishedDragging"))),(n instanceof KeyboardEvent||n instanceof FocusEvent)&&(this._isMouseDisabled=!1,this.getDraggedEntry()[0].setAttribute("aria-label",v.L_DraggableList_Keyboard_Drag_Start_Hint)),this._draggedEntryIndex=-1,this._insertIndex=-1,this._unfixContainerHeight(),this.onDragComplete.hasHandlersRegistered&&this.onDragComplete.invoke(i),this._haltEvent(n))},u.prototype._startDraggingElement=function(){this.getDraggedEntry().add_class("moving");r.addDataTag(this.getDraggedEntry(),"moving");this._setDraggedElementPosition()},u.prototype._setDraggedElementPosition=function(){this.getDraggedEntry().set_style({top:this._dragPositionY+"px",left:this._dragPositionX+"px"})},u.prototype._stopDraggingElement=function(){this.getDraggedEntry().remove_class("moving");this.getDraggedEntry().set_style({top:"",left:""});r.getFunctionalTestHooksEnabled()&&this.getDraggedEntry().remove_attr("data-tag")},u.prototype._getDragIndex=function(n){var r=n.target,i,u,t;if(r)for(i=this.getRootElement().select("[data-grip=grip]"),u=i.length,t=0;t<u;t++)if(i[t]===r)return t;return null},u.prototype._getItemIndex=function(n){var t=this.getItemsSource();return t.indexOf(n)},u.prototype._getDraggedElementHeight=function(){return this.getDraggedEntry().get_size().height},u.prototype._initializeDraggablesList=function(){this._draggablesList=f("[data-draggable=draggable]",this.getRootElement()[0])},u.prototype._getDragElementGimme=function(n){return f(this._draggablesList[n])},u.prototype._haltEvent=function(n){n.stopPropagation()},u.prototype._setThresholdArray=function(){for(var t,r=this.getItemsSource(),u=r.length,i=[],n=0;n<u;n++)t=this._getDragElementGimme(n),i[n]=t.get_relative_pos().y+t.get_size().height/2;this._thresholdArray=i},u.prototype._determineInsertIndex=function(n){if(n)return this._insertIndex+n;var r=this._dragPositionY+(this._leadingEdgeIsTop?0:this._getDraggedElementHeight()),t=this._insertIndex,u=this.getItemsSource(),i=u.length;if(this._leadingEdgeIsTop){while(t>=0){if(r>this._thresholdArray[t-1])break;t--}t<0&&(t=0)}else{while(t<i){if(r<this._thresholdArray[t+1])break;t++}t>=i&&(t=i-1)}return t},u.prototype._reorderItemsList=function(){var n=this.getItemsSource(),t=n[this._draggedEntryIndex];n.removeAt(this._draggedEntryIndex);n.insert(t,this._insertIndex)},u.prototype._updateGapAnimation=function(){var t=this._getDraggedElementHeight(),r=this._draggedEntryIndex<=this._insertIndex,n=this._draggedEntryIndex===this._insertIndex,i=this._draggedEntryIndex===0;this._stopGapAnimation();this._animateStartElement=this._getDragElementGimme(n?this._insertIndex+(i?1:-1):this._insertIndex);this._animateStartElement&&(r&&(n&&!i||!n)?this._animateStartElement.set_style({marginBottom:t+"px"}):this._animateStartElement.set_style({marginTop:t+"px"}))},u.prototype._stopGapAnimation=function(){this._animateStartElement&&(this._animateStartElement.set_style({marginTop:0,marginBottom:0}),this._animateStartElement=null)},u.prototype._determineNeedToAutoScroll=function(n){var u=this,t=0,f=this._getScrollContainer(),i=f.getBoundingClientRect(),r=this.getRootElement()[0].getBoundingClientRect();this._moveStartY>i.bottom-this._autoScrollBuffer&&this._moveStartY<=r.bottom?t=this._autoScrollStep:this._moveStartY<i.top+this._autoScrollBuffer&&this._moveStartY>=r.top&&(t=-1*this._autoScrollStep);t!==0&&this._timeoutId===0&&(this._timeoutId=Microsoft.Maps.setTimeout(function(){return u._updateAutoScroll(n,t)},this._timeoutLength))},u.prototype._updateAutoScroll=function(n,t){this._clearTimeOut();var i=this._getScrollContainer(),r=i.scrollTop+t;r>0&&r<i.scrollHeight-i.clientHeight&&(i.scrollTop=r,this._dragPositionY+=t,this._onDragMove(n))},u.prototype._getScrollContainer=function(){var n=null,t,i;return this.scrollContainer?n=this.scrollContainer:(t=f("[data-containerareatype=cardsContainer]"),i=t.getParent(),n=i[0]),n},u.prototype._clearTimeOut=function(){this._timeoutId!==0&&(window.clearTimeout(this._timeoutId),this._timeoutId=0)},u.prototype._onKeyDown=function(n){var i=n,t=i.keyCode||i.which,r=this.getDraggedEntry()&&this.getDraggedEntry()[0];t===13?this._isDragging?this._onDragEnd(n):this._onDragStart(n):t===38&&this._isDragging?this._insertIndex>0?this._onDragMove(n,-1):r.setAttribute("aria-label",v.L_DraggableList_Keyboard_Drag_Top_Error_Hint):t===40&&this._isDragging&&(this._insertIndex<this.getItemsSource().length-1?this._onDragMove(n,1):r.setAttribute("aria-label",v.L_DraggableList_Keyboard_Drag_Bottom_Error_Hint))},u.prototype._onChanged=function(){},u.prototype._onDraggedEntryChanged=function(){},u.prototype._fixContainerHeight=function(){var n=this.getRootElement()[0];n&&(n.style.minHeight=n.clientHeight+"px")},u.prototype._unfixContainerHeight=function(){var n=this.getRootElement()[0];n&&(n.style.minHeight="0")},u}(y);n.registerControl("DraggableList",at);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();vt=function(i){function r(){var t=i.call(this)||this;return t._templateString='<div class="{TemplateBinding Class}" data-tag="popOutTop"><div class="popOutInner" data-tag="popOutInner"><ContentPresenter /><\/div><\/div>',t.defineProperty("class",null,null,{defaultValue:"popOutTop"}),t.setTemplate(new n(t._templateString,null)),t}return t(r,i),r}(w);n.registerControl("PopOut",vt);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();yt=function(i){function r(){var t=i.call(this)||this;return t._templateString='<div class="bm_popOutContainer" data-tag="popOutContainer"><a class="{TemplateBinding ButtonClass}" event:click="onButtonClick" href="#"><TextBlock Text="{TemplateBinding ButtonText}" /><\/a><div class="popOutTemplate" data-tag="popOutTemplate" style:display="{TemplateBinding IsDisplayed Converter=displayPopOut}" event:click="onPopOutClick" event:touchend="onPopOutClick" event:mousewheel="onMouseWheel" ><PopOutPresenter /><\/div><\/div>',t.defineProperty("popOutContent"),t.defineProperty("popOutTemplate"),t.defineProperty("buttonText"),t.defineProperty("buttonClass",null,null,{defaultValue:"popOutButton"}),t.defineProperty("isDisplayed",function(n,i){return t._onDisplayChange(n,i)},null,{defaultValue:!1}),t.setTemplate(new n(t._templateString,{onButtonClick:function(n){return t._onButtonClick(n)},onPopOutClick:function(n){n.stopPropagation()},onMouseWheel:function(n){return t._onMouseWheel(n)},displayPopOut:function(n){return t.displayPopOut(n)}})),t._windowClickEventHandler=function(n){var i=n.target,f=t.getRootElement(),r,u;f&&f.has(i)||(r=i&&i.className.toString(),r==="dropdownEntry"&&i.childElementCount>0&&i.children[0].childElementCount>0&&(i=i.children[0].childNodes[0],r=i.className.toString()),u=i&&i.parentElement&&i.parentElement.className&&i.parentElement.className.toString(),r&&r.indexOf("feedbackMenuLink")!==-1||u&&u.indexOf("feedbackMenuLink")!==-1||t._hidePopOut(n))},t}return t(r,i),r.prototype.displayPopOut=function(n){return n?"block":"none"},r.prototype.dispose=function(){f(window).remove_event("click,contextmenu",this._windowClickEventHandler);i.prototype.dispose.call(this)},r.prototype._onButtonClick=function(n){this.setIsDisplayed(!this.getIsDisplayed());n.preventDefault()},r.prototype._onMouseWheel=function(n){n.stopPropagation()},r.prototype._onDisplayChange=function(n,t){var r=this,i=f(window);t?Microsoft.Maps.setTimeout(function(){i.add_event("click,contextmenu",r._windowClickEventHandler,!0)},1):n&&i.remove_event("click,contextmenu",this._windowClickEventHandler)},r.prototype._hidePopOut=function(){this.getRootElement()[0]?this.setIsDisplayed(!1):f(window).remove_event("click,contextmenu",this._windowClickEventHandler)},r}(e);n.registerControl("PopOutButton",yt);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();pt=function(i){function u(){var t=i.call(this)||this;return t._templateString='<div class="{TemplateBinding Class}" aria-label="{TemplateBinding AriaLabel}" event:mousemove="onScroll" event:touchmove="onScroll" event:pointermove="onScroll" data-tag="popOutTop"><div class="popOutInner" data-tag="popOutInner"><ItemsPresenter /><\/div><\/div>',t.defineProperty("class",null,null,{defaultValue:"popOutTop"}),t.defineProperty("ariaLabel"),t.itemContainerGenerator=t,t.onEntryClicked=new h,t.onEntryMouseover=new h,t.onEntryMouseout=new h,t.setTemplate(new n(t._templateString,{onScroll:function(n){n.stopPropagation();n.cancelBubble=!0}})),t}return t(u,i),u.prototype.generateNext=function(n){var t=this,f=this.getItemsSource(),e=f.indexOf(n),u=function(n){t._entryClicked(n)},o=function(n){t._entryMouseover(n)},h=function(n){t._entryMouseout(n)},c=function(n){t._entryKeydown(n)},i;return n.separator?i=s._createElement("div").add_class("dropdownSeparator"):(i=s._createElement("a").add_event("click",u).add_event("touchend",u).add_event("mouseover",o).add_event("mouseout",h).add_event("keydown",c).add_class("dropdownEntry").set_attr("data-dropdown",""+e).set_attr("href","#"),r.addDataTag(i,"dropdownEntry")),i},u.prototype._entryClicked=function(n){if(n.stopPropagation(),n.preventDefault(),n.type!=="pointerup"||f(".mapContainer .MicrosoftMap").has(n.target)){var t=parseInt(f(n.currentTarget).get_attr("data-dropdown"));this.onEntryClicked.invoke(t)}},u.prototype._entryMouseover=function(n){var t=parseInt(f(n.currentTarget).get_attr("data-dropdown"));this.onEntryMouseover.invoke(t);n.stopPropagation();n.preventDefault()},u.prototype._entryMouseout=function(n){var t=parseInt(f(n.currentTarget).get_attr("data-dropdown"));this.onEntryMouseout.invoke(t);n.stopPropagation();n.preventDefault()},u.prototype._entryKeydown=function(n){var t;n.keyCode===40&&n.target.nextSibling?(t=n.target.nextSibling,t.focus()):n.keyCode===38&&n.target.previousSibling&&(t=n.target.previousSibling,t.focus())},u}(y);n.registerControl("Dropdown",pt);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();wt=function(n){function i(){var t=n.call(this)||this;return t.defineProperty("text",function(n,i){return t.onTextChanged(n,i)}),t._root=document.createTextNode(""),t}return t(i,n),i.prototype.getRootElement=function(){return f(this._root)},i.prototype.dispose=function(){n.prototype.dispose.call(this);this._root=null},i.prototype.onTextChanged=function(n,t){this._root.nodeValue=t},i}(k);n.registerControl("TextBlock",wt);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();bt=function(n){function i(){var t=n.call(this)||this;return t.defineProperty("formattedtext",function(n,i){return t.onFormattedTextChanged(n,i)}),t._root=document.createElement("span"),t}return t(i,n),i.prototype.getRootElement=function(){return f(this._root)},i.prototype.dispose=function(){n.prototype.dispose.call(this);this._root=null},i.prototype.onFormattedTextChanged=function(n,t){for(var r="",i=0,u;i<t.length;)i<=t.length-3&&t.substr(i,3)==="<b>"?(r.length&&this._root.appendChild(document.createTextNode(r)),r="",i+=3):i<=t.length-4&&t.substr(i,4)==="<\/b>"?(u=document.createElement("b"),u.textContent=r,this._root.appendChild(u),r="",i+=4):(r+=t[i],i++);r.length>0&&this._root.appendChild(document.createTextNode(r))},i}(k);n.registerControl("FormattedTextBlock",bt);t=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}();kt=function(i){function r(){var t=i.call(this)||this,e,u,f;return t._isFocused=!1,e=r._supportsPlaceholder,t.defineProperty("watermark"),t.defineProperty("maxLength"),t.defineProperty("value",e?null:t._onValueChanged),t.onEnter=new h,u={onKeydown:function(n){return t._onKeydown(n)}},f=r._commonTemplate,e?f+=r._dataTagTemplate+=r._placeholderTemplate:(f+=r._dataTagTemplate+=r._downlevelTemplate,u.onFocus=function(){return t._onFocus()},u.onBlur=function(){return t._onBlur()}),t.setTemplate(new n(f,u)),t}return t(r,i),r.prototype._onKeydown=function(n){if(this.onEnter.hasHandlersRegistered&&n.type==="keydown"){var t=n;(t.keyCode===13||t.which===13)&&this.onEnter.invoke()}},r.prototype._onFocus=function(){this._isFocused=!0;this._showWatermark(!1)},r.prototype._onBlur=function(){this._isFocused=!1;this.getValue()===""&&this._showWatermark(!0)},r.prototype._onValueChanged=function(n,t){this._isFocused||this._showWatermark(!t)},r.prototype._showWatermark=function(n){var t=this.getRootElement(),i=t[0],u=r._className;n?(i.value=this.getWatermark(),t.add_class(u)):(i.value=this.getValue(),t.remove_class(u))},r._supportsPlaceholder="placeholder"in document.createElement("input"),r._commonTemplate='<input type="text" maxlength="{TemplateBinding maxLength}" title="{TemplateBinding watermark}" value="{TemplateBinding Value Mode=TwoWay}" event:keydown="onKeydown" aria-label="{TemplateBinding Value}"',r._placeholderTemplate=' placeholder="{TemplateBinding watermark}" />',r._dataTagTemplate=' data-tag="watermarkInput"',r._downlevelTemplate=' event:focus="onFocus" event:blur="onBlur" />',r._className="watermarkText",r}(e);n.registerControl("WatermarkedTextInput",kt);var ai='<div id="{Binding primitive.entity.id}" class="infoboxOverlay">    <div class="infoboxTitle">        <TextBlock Text="{Binding primitive.entity.title}" />    <\/div>    <div class="infoboxDescription">        <TextBlock Text="{Binding primitive.entity.description}"/>    <\/div>    <div class="infoboxActions">        <ul class="infoboxActionList">            <ItemsControl ItemsSource="{Binding primitive.entity.actions}">                <ItemsControl.ItemTemplate>                    <DataTemplate>                        <li>                            <a href="#" title="{Binding text}" class="{Binding cssClass}" event:click="handler" data-task="{Binding taskData}" />                        <\/li>                    <\/DataTemplate>                <\/ItemsControl.ItemTemplate>            <\/ItemsControl>        <\/ul>    <\/div><\/div>',vi=function(){function n(n){var i,t;this._style={};this._arrowHeadParts=n.arrowHeadParts;this._arrowShaftLength=n.arrowShaftLength;this._arrowShaftSpacing=n.arrowShaftSpacing;this._arrowHeadLength=n.arrowHeadLength;i=n.arrowAngle;this._arrowHeadAngle=g.degreesToRadians(i);t=n.arrowAngleFill;this._arrowHeadFillAngle=g.degreesToRadians(t);this._cosHeadAngle=Math.cos(this._arrowHeadAngle);this._sinHeadAngle=Math.sin(this._arrowHeadAngle);this._cosFillAngle=Math.cos(this._arrowHeadFillAngle);this._sinFillAngle=Math.sin(this._arrowHeadFillAngle);this._headStrokeStyle=n;this._style.strokeStyle=n.strokeStyle;this._style.lineWidth=n.lineWidth;this._style.arrowHeadStrokeWidth=n.arrowHeadStrokeWidth;(this._style.arrowHeadStrokeWidth!==n.lineWidth||t)&&(this._headStrokeStyle={dashes:n.dashes,lineCap:n.lineCap,lineJoin:n.lineJoin,strokeStyle:n.strokeStyle,lineWidth:n.arrowHeadStrokeWidth},this._arrowHeadFillAngle&&(this._headStrokeStyle.lineCap="butt",this._headStrokeStyle.lineJoin="miter"))}return n.prototype.renderGroup=function(n,t,i){for(var r=0;r<t.length;r++)this._render(n,t[r],i)},n.prototype.getIsHitTestable=function(){return this._style.hitTest===1},n.prototype._render=function(n,t,i){function et(n,t,i,r,u){var s=0,h=0,e=0,o=0,c=0,l=0,a,v,p,d;return e=n-i,o=t-r,a=Math.sqrt(e*e+o*o),a<=0&&(a=1),e/=a,o/=a,c=-o,l=e,g=e*f._arrowShaftLength,nt=o*f._arrowShaftLength,b=e,k=o,v=f._cosHeadAngle*u,e*=v,o*=v,s+=e,h+=o,p=f._sinHeadAngle*u,c*=p,l*=p,s-=c,h-=l,tt=s,it=h,s+=c+c,h+=l+l,rt=s,ut=h,f._arrowHeadFillAngle?(s-=c,h-=l,d=f._cosFillAngle*u,s-=b*d,h-=k*d,y=s,w=h):y=w=0,a}function ot(){y||w?(n.setStyle(f._headStrokeStyle),e.moveTo(r,u),f._arrowHeadParts&2&&e.lineTo(r+rt,u+ut),e.lineTo(r+y,u+w),f._arrowHeadParts&1&&e.lineTo(r+tt,u+it),e.closePath(),n.flush(),n.setStyle(f._style),e.moveTo(r+g,u+nt),e.lineTo(r+y,u+w),n.stroke(),n.flush()):(n.setStyle(f._headStrokeStyle),f._arrowHeadParts&2&&(e.moveTo(r+rt,u+ut),e.lineTo(r,u)),f._arrowHeadParts&1&&(e.moveTo(r+tt,u+it),e.lineTo(r,u)),n.stroke(),n.flush(),n.setStyle(f._style),e.moveTo(r+g,u+nt),e.lineTo(r,u),n.stroke(),n.flush())}var f=this,e=n.getRawContext(),ft=t.geometry,o=new p(t.crs,i),l,a,h,c;if(this._arrowHeadParts){var v=ft.x,d=ft.y,tt,it,rt,ut,y,w,g,nt,b,k,r,u,s=this._arrowShaftLength+this._arrowShaftSpacing>>1;if(o.project(v[0],d[0]),l=o.lastProjectedX,a=o.lastProjectedY,o.project(v[1],d[1]),h=et(l,a,o.lastProjectedX,o.lastProjectedY,this._arrowHeadLength+2),!(h<=0))if(v.length===2&&h<this._arrowShaftLength+s)n.arrowDrawAccumulator+=h,h>this._arrowShaftLength-1&&n.arrowDrawAccumulator>=this._arrowShaftSpacing&&(n.arrowDrawAccumulator=0,r=l-(b*this._arrowShaftLength+g)*.5,u=a-(k*this._arrowShaftLength+nt)*.5,ot());else for(c=0;c<v.length-1;c++){for(c!==0&&(o.project(v[c],d[c]),l=o.lastProjectedX,a=o.lastProjectedY,o.project(v[c+1],d[c+1]),h=et(l,a,o.lastProjectedX,o.lastProjectedY,this._arrowHeadLength+2)),r=l-b*s,u=a-k*s;h>=s+this._arrowShaftLength;)ot(),s+=this._arrowShaftLength+this._arrowShaftSpacing,r=l-b*s,u=a-k*s;h-s>0?s=this._arrowShaftLength:s-=h}}},n}(),yi=function(){function n(n){n.fillStyle&&!n.strokeStyle&&(n.strokeStyle=n.fillStyle,n.lineWidth=typeof n.lineWidth=="number"?n.lineWidth:1);this._style=n}return n.prototype.getStyle=function(){return this._style},n.prototype.isInBounds=function(n,t){var i=n.geometry.bounds,f,r,u;return!i||i.length!==4||i[0]===0&&i[1]===0&&i[2]===0&&i[3]===0?!0:n.geometryType===3||n.geometryType===2?(f=fi.fromRegionId(t,!0),r=n.geometry.boundingBox,r||(u=new ii,u.accumulate(n.geometry.bounds,n.crs),r=u.getBounds(),n.geometry.boundingBox=r),f.intersects(r,.1)):!0},n.prototype.render=function(n,t,i,r){this.renderGroup(n,[t],i,r)},n.prototype.renderGroup=function(n,t,i,u){var s=n.getRawContext(),h,c,tt=i.crs,l,nt=i.zoom,o,d,g,f;for(n.setStyle(this._style,u),f=0;f<t.length;f++){o=t[f];n.setPrimitive(o);c!==o.crs&&(c=o.crs,l=new p(c,i),h=l.getMatrix());var a=o.geometry,y=o.geometryType,e=a.boundingBox,w=e&&e.crossesInternationalDateLine();if(w||!h||!this._renderMatrixTransform(n,s,a,y,h)){r.logShapePrimitive(o);var b=0,k=0,v=e&&e.originalBounds;for(w&&v&&isFinite(v[1])&&isFinite(v[3])&&(d=Math.min(e.originalBounds[1],e.originalBounds[3]),g=Math.max(e.originalBounds[1],e.originalBounds[3]),k=Math.round(-d/360),b=Math.round(-g/360)),f=b;f<=k;f++)this._renderProjectionTransform(n,s,a,y,l,nt,f)}}this._matrixTransformed&&(s.restore(),this._matrixTransformed=null);n.flush()},n.prototype.getIsHitTestable=function(){return this._style.hitTest===1},n.prototype._renderMatrixTransform=function(n,t,i,r,u){var a,c,s,e,o,h,f;if(this._matrixTransformed!==u){if(this._matrixTransformed&&(t.restore(),this._matrixTransformed=null),r===2&&Math.abs(Math.abs(u[0]/u[3])-1)>.1)return!1;t.save();t.lineWidth*=1/u[0];t.transform.apply(t,u.getValues());this._matrixTransformed=u}switch(r){case 2:var l=i,e=l.x,o=l.y;for(t.moveTo(e[0],o[0]),h=e.length,f=1;f<h;f++)n.lineTo(e[f],o[f],e[f-1],o[f-1]);return n.stroke(),!0;case 3:for(a=i,c=a.rings,s=0;s<c.length;s++){for(e=c[s].x,o=c[s].y,t.moveTo(e[0],o[0]),h=e.length,f=1;f<h;f++)n.lineTo(e[f],o[f],e[f-1],o[f-1]);t.closePath()}return n.stroke(),n.fill(),!0}},n.prototype._renderProjectionTransform=function(n,t,i,r,u,f,e){var h,c,s,o;this._matrixTransformed&&(t.restore(),this._matrixTransformed=null);switch(r){case 2:h=i;this._renderProjection(n,t,h,u,f,e);n.stroke();break;case 3:for(c=i,s=c.rings,o=0;o<s.length;o++)this._renderProjection(n,t,s[o],u,f,e),t.closePath();n.stroke();n.fill()}},n.prototype._renderProjection=function(n,t,i,r,u,f){var e,o;(!i.rawX||r.destinationCrs!==i.projectedCrs||i.projectedCrs&&i.projectedCrs.sceneMetadata)&&(i.rawX=[],i.rawY=[],i.projectedCrs=r.destinationCrs);e=ri.instance.getGeneralizations(i,u,r);r.calculateProjectedCoordinates(0,i,f);t.moveTo(r.lastProjectedX,r.lastProjectedY);var s=r.lastProjectedX,h=r.lastProjectedY,l=e?e.length:i.x.length,c;for(o=1;o<l;o++)c=e?e[o]:o,r.calculateProjectedCoordinates(c,i,f),n.lineTo(r.lastProjectedX,r.lastProjectedY,s,h),s=r.lastProjectedX,h=r.lastProjectedY},n}(),dt=function(){function n(n,t,i){n instanceof HTMLImageElement?this._image=n:(this._image=document.createElement("img"),this._image.src=n);this._scale=t||1;this._anchor=i||new l(0,0,1);this._hitTest=1}return n.prototype.isInBounds=function(){return!0},n.prototype.render=function(n,t,i,r,u){this.renderGroup(n,[t],i,r,u)},n.prototype.renderGroup=function(n,t,i,r,u){if(t&&this._image)for(var f=0;f<t.length;f++)this._render(n,t[f],i,r,u)},n.prototype.getAnchorPoint=function(){var n=this._getMetrics();return new a(n.scaleX*n.anchorX,n.scaleY*n.anchorY)},n.prototype.getBounds=function(){var n=this._getMetrics(),t=n.anchorX,i=n.anchorY,r=n.scaleX,u=n.scaleY;return c.fromSides(-(r*t),r*(n.width-t),-(u*i),u*(n.height-i))},n.prototype.getIsHitTestable=function(){return this._hitTest===1},n.prototype.renderCanvas=function(n,t,i,u,f,e,o){f===void 0&&(f=1);var s=this._anchor,h=this._image,c=h.naturalWidth||h.width,l=h.naturalHeight||h.height;f=f*this._scale;s.units===0?(i-=f*s.x*c,u-=f*s.y*l):(i-=f*s.x,u-=f*s.y);n.drawImage(this._image,Math.round(i),Math.round(u),c*f,l*f);e&&o&&r.logPushpinPrimitive(e,o)},n.prototype._getMetrics=function(){var n=this._scale,t=this._image.naturalWidth||this._image.width,i=this._image.naturalHeight||this._image.height,r=this._anchor.x,u=this._anchor.y;return this._anchor.units===0&&(r*=t,u*=i),{anchorX:r,anchorY:u,scaleX:n,scaleY:n,width:t,height:i}},n.prototype._render=function(n,t,i,r,u){var e=t.geometry,f=new p(t.crs,i);f.project(e.x,e.y);this.renderCanvas(n,t.entity,f.lastProjectedX,f.lastProjectedY,r,u,t)},n}(),p=function(){function n(n,t){var i,u;r.assertNotNull(n,"sourceCrs");r.assertNotNull(t,"destinationRegionId");this._xOffset=-t.bounds[3];this._yOffset=-t.bounds[0];this._xScale=t.pixelWidth/(t.bounds[1]-t.bounds[3]);this._yScale=t.pixelHeight/(t.bounds[2]-t.bounds[0]);this._sourceCrs=n;this.destinationCrs=t.crs;i=this.destinationCrs.bounds;this._destinationCrsWidth=i[1]-i[3];u=this._sourceCrs.getMatrix&&this._sourceCrs.getMatrix(this.destinationCrs);u&&(this._matrix=u.translate(this._xOffset,this._yOffset).scale(this._xScale,this._yScale))}return n.prototype.project=function(n,t){this._project(n,t,!0,0)},n.prototype._project=function(n,t,i,r){if(this._matrix&&!r)this.lastProjectedX=this._matrix.projectX(n,t),this.lastProjectedY=this._matrix.projectY(n,t);else{var u=this._sourceCrs.toLatitude(n,t),f=this._sourceCrs.toLongitude(n,t);this.lastRawX=this.destinationCrs.projectToX(u,f,i);this.lastRawY=this.destinationCrs.projectToY(u,f);this._projectFromRawCoordinate(this.lastRawX,this.lastRawY,r)}},n.prototype._projectFromRawCoordinate=function(n,t,i){this.lastRawX=n;this.lastRawY=t;i&&(i=i*this._destinationCrsWidth||0);this.lastProjectedX=(n+this._xOffset+i)*this._xScale;this.lastProjectedY=(t+this._yOffset)*this._yScale},n.prototype.getMatrix=function(){return this._matrix},n.prototype.calculateProjectedCoordinates=function(n,t,i){t.rawX[n]?this._projectFromRawCoordinate(t.rawX[n],t.rawY[n],i):(this._project(t.x[n],t.y[n],!1,i),t.rawX[n]=this.lastRawX,t.rawY[n]=this.lastRawY)},n}(),pi=function(){function t(){}return t.getDefaultOverlayTemplate=function(){return t._defaultOverlayTemplate||(t._defaultOverlayTemplate=new n(ai)),t._defaultOverlayTemplate},t}(),wi=function(){function n(){}return n}(),gt=function(){function n(t,i,r){var o,f,l,u,e;this._image=t;typeof i!="number"&&(i=1);this._scale=i;this._anchor=r;this._cachedTextScale={};o=typeof d!="undefined"&&d.features.labels;this._measureIconText=o&&o.measureIconText;var c=[],s=[],h=t.records||[];for(f=0,l=h.length;f<l;f++)u=h[f],u.vectorType===undefined&&(u=h[f]=this.fromBackendRecord(u)),u.vectorType===3?(e=u,s.push(e),e.text===n._placeholderText&&(this.hasPlaceholderText=!0,this._templateTextRecord=e)):c.push(u);this._vectorRecords=c;this._textRecords=s;this.hasText=!!s.length}return n.prototype.fromBackendRecord=function(t){var f=null,i,e,u,r,o,s;switch(t.recordType){case"Ellipse":i=t;f={centerX:i.cX,centerY:i.cY,radiusX:i.rX,radiusY:i.rY,style:{lineWidth:t.lineStyle.strokeWidth,strokeStyle:t.lineStyle.color,strokeStylePaletteKey:t.lineStyle.colorStylePaletteKey},vectorType:2,scale:t.scale};break;case"FilledEllipse":i=t;f={centerX:i.cX,centerY:i.cY,radiusX:i.rX,radiusY:i.rY,style:{fillStyle:t.color,fillStylePaletteKey:t.colorStylePaletteKey},vectorType:2,scale:t.scale};break;case"Path":e=t;f={pathData:e.geometryString,style:{fillStyle:e.fill,lineWidth:e.strokeWidth,strokeStyle:e.stroke,fillStylePaletteKey:e.fillStylePaletteKey,strokeStylePaletteKey:e.strokeStylePaletteKey},vectorType:4,scale:t.scale};break;case"Polygon":u=t;f={pointsList:u.pointsList,style:{fillStyle:u.color,fillStylePaletteKey:u.colorStylePaletteKey},vectorType:0,scale:u.scale};break;case"Polyline":u=t;f={pointsList:u.pointsList,style:{lineWidth:u.lineDrawStyle.strokeWidth,strokeStyle:u.lineDrawStyle.color},vectorType:1,scale:t.scale};break;case"Text":r=t;o=r.leftTop||{x:0,y:0};s=r.rightBottom||o;f={style:{fillStyle:r.textStyle.color,font:r.textStyle.fontFamily||n._defaultFont,fontStyle:r.textStyle.fontStyle,fontSize:r.textStyle.fontSize,horizontalAutoScaling:r.horizontalAutoScaling,fillStylePaletteKey:r.textStyle.colorStylePaletteKey},text:r.text||n._placeholderText,anchor:{x:(o.x+s.x)/2,y:(o.y+s.y)/2},maxWidth:s.x-o.x,vectorType:3,scale:t.scale}}return f},n.getDefaultFontFamily=function(t){var i=d.features.labels,r=t.toLowerCase();return r==="segoebing"?i.useSegoeFontStack?t.concat(", "+n._segoeFontStack):n._reducedFontStack:r==="segoe ui"?i.useSegoeFontStack?n._segoeFontStack:n._reducedFontStack:t},n.prototype.getVectorImage=function(){return this._image},n.prototype.getScale=function(){return this._scale},n.prototype.setScale=function(n){this._scale=n===0?0:n||1},n.prototype.isInBounds=function(){return!0},n.prototype.render=function(n,t,i,r,u){this.renderGroup(n,[t],i,r,u)},n.prototype.renderGroup=function(n,t,i,r,u){var e,f,s,o,h,c;if(t)for(e=0;e<t.length;e++)f=t[e],f&&(s=f.geometry,o=new p(f.crs,i),o.project(s.x,s.y),h=o.lastProjectedX,c=o.lastProjectedY,this.renderCanvas(n,f.entity,h,c,r,u,f))},n.prototype._getTextScale=function(t){var i=this._templateTextRecord,e=this._cachedTextScale,f=1,u,r,h,c;if(t=t||"",u=t.length||0,r=e[t],r)return r;if(this._measureIconText){if(u>1&&i&&i.maxWidth>0&&i.style.horizontalAutoScaling===1){var o=n._scratchContext,s=this._bounds.getSize().width,l=s-i.maxWidth;typeof i.style.fontStyleString!="string"&&n._processFontStyle(i);o.setFont(i.style.fontStyleString+i.style.fontSize+"pt "+n.getDefaultFontFamily(i.style.font));h=o.getRawContext().measureText(t).width;c=l+h;f=Math.max(1,c/s)}}else u>3&&(f=1.5+.2*(u-4));return r=new ei(f,1),e[t]=r,r},n.prototype.getAnchorPoint=function(n){var t=this._getMetrics(n),i=this._bounds.minPoint;return new a(t.scaleX*(t.anchorX-i.x),t.scaleY*(t.anchorY-i.y))},n.prototype.getBounds=function(n){var t=this._getMetrics(n),r=t.anchorX,u=t.anchorY,f=t.scaleX,e=t.scaleY,i=this._bounds;return c.fromSides(f*(i.minPoint.x-r),f*(i.maxPoint.x-r),e*(i.minPoint.y-u),e*(i.maxPoint.y-u))},n.prototype._getMetrics=function(n){this._parseRecords();var o=this._bounds,t=o.getSize(),i=t.width,r=t.height,u=this.hasText&&this._getTextScale(n)||{width:1,height:1},s=u.width*this._scale,h=u.height*this._scale,f=this._anchor.x,e=this._anchor.y;return this._anchor.units===0&&(f*=i,e*=r),{anchorX:f,anchorY:e,scaleX:s,scaleY:h,width:i,height:r}},n.prototype.getIsHitTestable=function(){return this._image.hitTest===1},n.prototype._parseRecords=function(){var n=this._bounds,t=this._image,r,i,u;if(!n){for(n=c.empty(),r=t.records||[],i=0,u=r.length;i<u;i++)n.union(this._parseRecord(r[i]));this._bounds=n}this._anchor||(typeof t.hotspotX=="number"&&typeof t.hotspotY=="number"||n.isEmpty()||(t.hotspotX=(n.minPoint.x+n.maxPoint.x)/2,t.hotspotY=(n.minPoint.y+n.maxPoint.y)/2),this._anchor=new l(t.hotspotX,t.hotspotY))},n.prototype._parseRecord=function(t){var r,i;if(!t)return c.empty();r=t.vectorType||0;switch(r){case 2:i=t;t.bounds=c.fromPoints({x:i.centerX-i.radiusX,y:i.centerY-i.radiusY},{x:i.centerX+i.radiusX,y:i.centerY+i.radiusY});break;case 4:n._parsePathGeometry(t);break;case 0:case 1:t.bounds=c.fromPoints.apply(this,t.pointsList)}return t.bounds||c.empty()},n.prototype.renderCanvas=function(t,i,u,f,e,h,c){var k,it,nt,d,p,w,b,tt;if(e===void 0&&(e=1),k=this._image,u=Math.round(u),f=Math.round(f),k.records&&k.records.length>0){it=t.getRawContext();this._parseRecords();var g=this._getMetrics(),l=this._scale*e,a=l;i&&this.hasText&&(nt=o.getValue(i,"name")||o.getValue(i,"iconText"),d=this._getTextScale(nt),l*=d.width,a*=d.height);(l!=this._cachedScaleX||a!=this._cachedScaleY)&&(this._cachedVectorImage=this._cacheRecords(this._vectorRecords,null,l,a),this._cachedScaleX=l,this._cachedScaleY=a,this._cachedText=[],this._cachedTextImage=null);var rt=g.anchorX*l,ut=g.anchorY*a,v=u-rt,y=f-ut;v=isNaN(v)?0:v;y=isNaN(y)?0:y;t.hasPrimitives()?this._renderRecord(t,null,this._vectorRecords[0],v,y,l,a):(p=this._getTextValues(i),p.length&&!s._areArraysEqual(this._cachedText,p)&&(this._cachedTextImage=this._cacheRecords(this._textRecords,p,l,a),this._cachedText=p),w=n._cachedImageBuffer,t.drawImage(this._cachedVectorImage,v+l*this._bounds.minPoint.x-w/2,y+a*this._bounds.minPoint.y-w/2,this._cachedVectorImage.width/n._cachedImageOversample,this._cachedVectorImage.height/n._cachedImageOversample),this._cachedTextImage&&t.drawImage(this._cachedTextImage,v+l*this._bounds.minPoint.x-w/2,y+a*this._bounds.minPoint.y-w/2,this._cachedTextImage.width/n._cachedImageOversample,this._cachedTextImage.height/n._cachedImageOversample))}if(h&&c&&r.getFunctionalTestHooksEnabled()){for(b=0,tt=this._vectorRecords.length;b<tt;b++)r.logVectorImageRecord(h,this._vectorRecords[b],b);r.logPushpinPrimitive(h,c)}},n.prototype.renderIcon=function(n){var i=new b,t=this._getMetrics(n&&this.hasText?o.getValue(n,"name"):""),r=this._bounds.minPoint;return i.setSize(Math.ceil(t.scaleX*t.width),Math.ceil(t.scaleY*t.height)),this.renderCanvas(i,n,t.scaleX*(t.anchorX-r.x),t.scaleY*(t.anchorY-r.y)),i.getRootElement()},n.prototype._cacheRecords=function(t,i,r,u){var v=this._bounds.getSize(),h=n._cachedImageOversample,c=r*h,l=u*h,s=n._cachedImageBuffer*h,p=Math.ceil(c*v.width)+s,w=Math.ceil(l*v.height)+s,a=new b,f,e,o,y;for(a.setSize(p,w),f=-c*this._bounds.minPoint.x,e=-l*this._bounds.minPoint.y,f=(isNaN(f)?0:f)+s/2,e=(isNaN(e)?0:e)+s/2,o=0,y=this._vectorRecords.length;o<y;o++)this._renderRecord(a,i&&i[o],t[o],f,e,c,l);return a.getRootElement()[0]},n.prototype._getTextValues=function(t){for(var u,r=[],i=0,f=this._textRecords.length;i<f;i++)u=this._textRecords[i],r.push(n._getText(u,n._placeholderText,t,["iconText","name"]));return r},n.prototype._renderRecord=function(t,i,r,u,f,e,o){var c,h;if(r){c=r.vectorType||0;r.style&&t.setStyle(r.style,o);switch(c){case 0:r.style.fillStyle&&this._renderPolygonRecord(t,r,u,f,e,o);break;case 1:r.style.strokeStyle&&this._renderPolylineRecord(t,r,u,f,e,o);break;case 2:this._renderEllipseRecord(t,r,u,f,e,o);break;case 4:h=r;h.render&&(h.render(t,u,f,e,o),h.style.strokeStyle&&t.stroke(),h.style.fillStyle&&t.fill());break;case 3:var s=r,a=t.getRawContext(),l=s.anchor||{x:0,y:0},v=u+l.x*e,y=f+l.y*o;typeof s.style.fontStyleString!="string"&&n._processFontStyle(s);t.setFont(s.style.fontStyleString+s.style.fontSize*o+"pt "+n.getDefaultFontFamily(s.style.font));a.fillText(i,v,y)}t.flush()}},n._getFontWeight=function(n){var t="";return(n&1)!=0?t="bold":(n&16)!=0?t="bolder":(n&32)!=0&&(t="lighter"),t},n._getFontStyle=function(n){var t="";return(n&2)!=0&&(t="italic"),t},n._processFontStyle=function(t){var r=t.style.fontStyle,i=n._getFontWeight(r)+" "+n._getFontStyle(r);i=i.trim();i&&(i+=" ");t.style.fontStyleString=i},n.prototype._renderPolygonRecord=function(n,t,i,u,f,e){r.assertNotNull(n,"drawingContext");r.assertNotNull(t,"polygonRecord");var o=n.getRawContext();this._renderLines(o,t.pointsList,i,u,f,e);o.closePath();n.fill()},n.prototype._renderPolylineRecord=function(n,t,i,u,f,e){r.assertNotNull(n,"drawingContext");r.assertNotNull(t,"polylineRecord");var o=n.getRawContext();this._renderLines(o,t.pointsList,i,u,f,e);n.stroke()},n.prototype._renderEllipseRecord=function(n,t,i,u,f,e){r.assertNotNull(n,"drawingContext");r.assertNotNull(t,"ellipseRecord");n.drawEllipse(t.centerX*f+i,t.centerY*e+u,t.radiusX*f,t.radiusY*e);t.style.fillStyle&&n.fill();t.style.strokeStyle&&n.stroke()},n._getText=function(n,t,i,r){var e=n.text,u,f,s;if(e===t&&i){for(u=null,f=0,s=r.length;f<s;f++)if(u=o.getValue(i,r[f]),u)break;e=u||""}return e},n.prototype._renderLines=function(n,t,i,r,u,f){var e,o,s;if(n&&t&&t.length)for(e=t[0],n.moveTo(e.x*u+i,e.y*f+r),o=1,s=t.length;o<s;o++)e=t[o],n.lineTo(e.x*u+i,e.y*f+r);else throw"raw context is null or points array is invalid";},n._parsePathGeometry=function(t){function p(n,t){rt=at(rt,n);ft=at(ft,t);ht=vt(ht,n);ct=vt(ct,t)}var ot=t&&t.pathData,h,r,et,s,nt,e,o;if(!ot)throw"Invalid path geometry string";h=[];h.push("var rawContext = drawingContext.getRawContext();");for(var st=!1,g=0,tt=0,w=0,it=0,l=0,lt=0,ut="",i=[],b=!1,u=0,f=0,k=0,d=0,v=0,y=0,at=Math.min,vt=Math.max,rt=Number.MAX_VALUE,ft=rt,ht=-rt,ct=-ft;!st;){r=g<ot.length?ot.charAt(g):null;et=!1;switch(tt){case 0:if(r)if(r>="0"&&r<="9"||r==="."||r==="-"){if(it===0||it===2)throw"Encountered value with no valid command";w=it;l=lt}else if(r>="a"&&r<="z"||r>="A"&&r<="Z"){if(lt=l,r>="a"&&r<="z"?(l=2,r=r.toUpperCase()):l=1,it=w,w=n._pathCommands[r],!w){w=it;throw"Unknown command";}w===2?h.push("rawContext.closePath();"):(tt=1,i=[]);g++}else g++;else st=!0;break;case 1:r?r>="a"&&r<="z"||r>="A"&&r<="Z"?(tt=0,et=!0):r>="0"&&r<="9"||r==="."||r==="-"?(ut="",tt=2):g++:(st=!0,et=!0);break;case 2:r&&(r>="0"&&r<="9"||r==="."||r==="-"&&ut.length===0)?(ut+=r,g++):(i.push(parseFloat(ut)),tt=1);break;default:throw"Invalid state in parsing path geometry";}if(et){s=i.length;switch(w){case 1:if(s===0||(s&1)!=0)throw"Invalid number of parameters for MoveTo command";switch(l){case 1:u=i[s-2];f=i[s-1];break;case 2:u+=i[s-2];f+=i[s-1];break;default:throw"Unknown command type";}p(u,f);h.push("rawContext.moveTo("+u+" * scaleX + deltaX, "+f+" * scaleY + deltaY);");b=!1;break;case 3:if(s===0||(s&1)!=0)throw"Invalid number of parameters for LineTo command";for(nt=s/2,e=0;e<nt;e++){switch(l){case 1:u=i[e*2];f=i[e*2+1];break;case 2:u+=i[e*2];f+=i[e*2+1];break;default:throw"Unknown command type";}p(u,f);h.push("rawContext.lineTo("+u+" * scaleX + deltaX, "+f+" * scaleY + deltaY);");b=!1}break;case 4:if(s===0)throw"Invalid number of parameters for HorizontalLineTo command";for(e=0;e<s;e++){switch(l){case 1:u=i[e];break;case 2:u+=i[e];break;default:throw"Unknown command type";}p(u,f);h.push("rawContext.lineTo("+u+" * scaleX + deltaX, "+f+" * scaleY + deltaY);");b=!1}break;case 5:if(s===0)throw"Invalid number of parameters for VerticalLineTo command";for(e=0;e<s;e++){switch(l){case 1:f=i[e];break;case 2:f+=i[e];break;default:throw"Unknown command type";}p(u,f);h.push("rawContext.lineTo("+u+" * scaleX + deltaX, "+f+" * scaleY + deltaY);");b=!1}break;case 6:if(s===0||s%6!=0)throw"Invalid number of parameters for CurveTo command";for(nt=s/6,e=0;e<nt;e++){o=e*6;switch(l){case 1:k=i[o];d=i[o+1];v=i[o+2];y=i[o+3];u=i[o+4];f=i[o+5];break;case 2:k=u+i[o];d=f+i[o+1];v=u+i[o+2];y=f+i[o+3];u+=i[o+4];f+=i[o+5];break;default:throw"Unknown command type";}p(k,d);p(v,y);p(u,f);h.push("rawContext.bezierCurveTo("+k+" * scaleX + deltaX, "+d+" * scaleY + deltaY, "+v+" * scaleX + deltaX, "+y+" * scaleY + deltaY, "+u+" * scaleX + deltaX, "+f+" * scaleY + deltaY);");b=!0}break;case 7:if(s===0||s%4!=0)throw"Invalid number of parameters for SmartCurveTo command";for(b||(v=u,y=f),nt=s/4,e=0;e<nt;e++){k=u*2-v;d=f*2-y;o=e*4;switch(l){case 1:v=i[o];y=i[o+1];u=i[o+2];f=i[o+3];break;case 2:v=u+i[o];y=f+i[o+1];u+=i[o+2];f+=i[o+3];break;default:throw"Unknown command type";}p(k,d);p(v,y);p(u,f);h.push("rawContext.bezierCurveTo("+k+" * scaleX + deltaX, "+d+" * scaleY + deltaY, "+v+" * scaleX + deltaX, "+y+" * scaleY + deltaY, "+u+" * scaleX + deltaX, "+f+" * scaleY + deltaY);");b=!0}break;case 2:throw"Internal error in handling of Close command";default:throw"Invalid command";}}}t.render=new Function("drawingContext","deltaX","deltaY","scaleX","scaleY",h.join("\n"));t.bounds=new c(new a(rt,ft),new a(ht,ct))},n._reducedFontStack='Frutiger, "Frutiger Linotype", "Dejavu Sans", "Helvetica Neue", Arial, sans-serif',n._segoeFontStack='"Segoe UI", '+n._reducedFontStack,n._placeholderText="{MapDisplay}",n._cachedImageBuffer=4,n._cachedImageOversample=2,n._scratchContext=new b,n._pathCommands={M:1,Z:2,L:3,H:4,V:5,C:6,S:7,Q:8,T:9,A:10},n._defaultFont="SegoeBing",n}(),bi=function(){function n(){}return n.prototype.getTemplates=function(n){var r,i,u,t;if(n instanceof oi)i=o.getValue(n,"image"),i||(i=s._getImageFromCss("defaultPushpinImg"),o.setValue(n,"image",i)),i&&(u=i,u.records?r=new gt(u):(t=o.getValue(n,"anchor"),t?t instanceof a?t=new l(t.x,t.y):t instanceof l||(t=new l(0,0)):t=new l(13,39),o.setValue(n,"anchor",t),r=new dt(i,1,t)));else{if(n.getTemplates)return n.getTemplates();n.getTemplate&&(r=n.getTemplate())}return[r]},n.prototype.selectorReady=function(){return this._ready||(this._ready=Promise.resolve(this)),this._ready},n}();u.ContentControl=w;u.Control=e;u.ControlTemplate=n;u.Template=nt;i.ArrowTemplate=vi;i.BasicTemplate=yi;i.BitmapImageTemplate=dt;i.CommonTemplates=pi;i.CoordinateProjection=p;i.DefaultTemplateSelector=bi;i.VectorLabelTemplate=wi;i.VectorImageTemplate=gt}catch(ni){if(i.logger)i.logger.logCriticalError(ni);else throw ni;}}).call(window)